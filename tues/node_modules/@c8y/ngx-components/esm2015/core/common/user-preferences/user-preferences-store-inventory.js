import * as tslib_1 from "tslib";
export class UserPreferencesStorageInventory {
    constructor(inventory) {
        this.inventory = inventory;
        this.TYPE = 'c8y_UserPreference';
    }
    get(key) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { data } = yield this.inventory.list({ fragmentType: key });
            return data.length ? data[0][key] : undefined;
        });
    }
    set(key, value) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { data } = yield this.inventory.list({ fragmentType: key });
            const updateMo = { [key]: value, type: this.TYPE };
            let out;
            if (data.length) {
                updateMo.id = data[0].id;
                out = this.inventory.update(updateMo);
            }
            else {
                out = this.inventory.create(updateMo);
            }
            return out;
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1wcmVmZXJlbmNlcy1zdG9yZS1pbnZlbnRvcnkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYzh5L25neC1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsiY29yZS9jb21tb24vdXNlci1wcmVmZXJlbmNlcy91c2VyLXByZWZlcmVuY2VzLXN0b3JlLWludmVudG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsTUFBTSxPQUFPLCtCQUErQjtJQUcxQyxZQUNVLFNBQTJCO1FBQTNCLGNBQVMsR0FBVCxTQUFTLENBQWtCO1FBSHJDLFNBQUksR0FBRyxvQkFBb0IsQ0FBQztJQUl6QixDQUFDO0lBRUUsR0FBRyxDQUFDLEdBQUc7O1lBQ1gsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBQyxZQUFZLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQztZQUNoRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQ2hELENBQUM7S0FBQTtJQUVLLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSzs7WUFDbEIsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBQyxZQUFZLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQztZQUNoRSxNQUFNLFFBQVEsR0FBUSxFQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFDLENBQUM7WUFDdEQsSUFBSSxHQUFHLENBQUM7WUFFUixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7Z0JBQ2YsUUFBUSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUN6QixHQUFHLEdBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDeEM7aUJBQU07Z0JBQ0wsR0FBRyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ3ZDO1lBQ0QsT0FBTyxHQUFHLENBQUM7UUFDYixDQUFDO0tBQUE7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEludmVudG9yeVNlcnZpY2UgfSBmcm9tICdAYzh5L2NsaWVudCc7XG5cbmV4cG9ydCBjbGFzcyBVc2VyUHJlZmVyZW5jZXNTdG9yYWdlSW52ZW50b3J5IHtcbiAgVFlQRSA9ICdjOHlfVXNlclByZWZlcmVuY2UnO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgaW52ZW50b3J5OiBJbnZlbnRvcnlTZXJ2aWNlXG4gICkge31cblxuICBhc3luYyBnZXQoa2V5KSB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCB0aGlzLmludmVudG9yeS5saXN0KHtmcmFnbWVudFR5cGU6IGtleX0pO1xuICAgIHJldHVybiBkYXRhLmxlbmd0aCA/IGRhdGFbMF1ba2V5XSA6IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGFzeW5jIHNldChrZXksIHZhbHVlKSB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCB0aGlzLmludmVudG9yeS5saXN0KHtmcmFnbWVudFR5cGU6IGtleX0pO1xuICAgIGNvbnN0IHVwZGF0ZU1vOiBhbnkgPSB7W2tleV06IHZhbHVlLCB0eXBlOiB0aGlzLlRZUEV9O1xuICAgIGxldCBvdXQ7XG5cbiAgICBpZiAoZGF0YS5sZW5ndGgpIHtcbiAgICAgIHVwZGF0ZU1vLmlkID0gZGF0YVswXS5pZDtcbiAgICAgIG91dCA9ICB0aGlzLmludmVudG9yeS51cGRhdGUodXBkYXRlTW8pO1xuICAgIH0gZWxzZSB7XG4gICAgICBvdXQgPSB0aGlzLmludmVudG9yeS5jcmVhdGUodXBkYXRlTW8pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG59XG4iXX0=