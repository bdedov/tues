import * as angular from 'angular';
function c8yTitleDecorator($q, $delegate, $injector, $rootScope, $location, $templateCache, $compile, c8yHeaderService) {
    'ngInject';
    $delegate.changeTitle = changeTitle;
    $delegate.setTitleElement = setTitleElement;
    $rootScope.$on('$routeChangeStart', () => {
        changeTitle({});
    });
    $rootScope.$on('$routeChangeSuccess', (event) => {
        const title = $delegate.get($location.path());
        if (title) {
            const titleData = $q.when(title.data ? $injector.invoke(title.data) : {});
            titleData.then((data) => {
                const { templateUrl } = data;
                if (templateUrl) {
                    const template = $templateCache.get(templateUrl);
                    setTitleElement($compile(template)(event.targetScope));
                }
                else {
                    changeTitle(data);
                }
            });
        }
    });
    function changeTitle(newTitle) {
        $q.when(newTitle).then((title) => changeTitleInAngular(translate(title)));
    }
    function translate({ title, subtitle }) {
        const isolatedScope = $rootScope.$new(true);
        isolatedScope.title = title;
        isolatedScope.subtitle = subtitle;
        return $compile(angular.element(`
      <h1 class="text-truncate">{{title | translate}}
      <small>{{ subtitle | translate }}</small></h1>
    `))(isolatedScope)[0];
    }
    function changeTitleInAngular(domElement) {
        c8yHeaderService.changeTitle(domElement);
    }
    function setTitleElement($element) {
        $element.show();
        changeTitleInAngular($element[0]);
    }
    return $delegate;
}
export { c8yTitleDecorator };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGl0bGUuZGVjb3JhdG9yLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy91cGdyYWRlLyIsInNvdXJjZXMiOlsibmcxL3RpdGxlLmRlY29yYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssT0FBTyxNQUFNLFNBQVMsQ0FBQztBQUVuQyxTQUFTLGlCQUFpQixDQUN4QixFQUFFLEVBQ0YsU0FBUyxFQUNULFNBQVMsRUFDVCxVQUFVLEVBQ1YsU0FBUyxFQUNULGNBQWMsRUFDZCxRQUFRLEVBQ1IsZ0JBQWdCO0lBRWhCLFVBQVUsQ0FBQztJQUVYLFNBQVMsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQ3BDLFNBQVMsQ0FBQyxlQUFlLEdBQUcsZUFBZSxDQUFDO0lBRTVDLFVBQVUsQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNsQixDQUFDLENBQUMsQ0FBQztJQUVILFVBQVUsQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtRQUM5QyxNQUFNLEtBQUssR0FBRyxTQUFTLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQzlDLElBQUksS0FBSyxFQUFFO1lBQ1QsTUFBTSxTQUFTLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDMUUsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO2dCQUN0QixNQUFNLEVBQUUsV0FBVyxFQUFFLEdBQUcsSUFBSSxDQUFDO2dCQUM3QixJQUFJLFdBQVcsRUFBRTtvQkFDZixNQUFNLFFBQVEsR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO29CQUNqRCxlQUFlLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO2lCQUN4RDtxQkFBTTtvQkFDTCxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7aUJBQ25CO1lBQ0gsQ0FBQyxDQUFDLENBQUM7U0FDSjtJQUNILENBQUMsQ0FBQyxDQUFDO0lBRUgsU0FBUyxXQUFXLENBQUMsUUFBUTtRQUMzQixFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsb0JBQW9CLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1RSxDQUFDO0lBRUQsU0FBUyxTQUFTLENBQUMsRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDO1FBQ2xDLE1BQU0sYUFBYSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDNUMsYUFBYSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDNUIsYUFBYSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDbEMsT0FBTyxRQUFRLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQzs7O0tBRy9CLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFFRCxTQUFTLG9CQUFvQixDQUFDLFVBQVU7UUFDdEMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFFRCxTQUFTLGVBQWUsQ0FBQyxRQUFRO1FBQy9CLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNoQixvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRUQsT0FBTyxTQUFTLENBQUM7QUFDbkIsQ0FBQztBQUVELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcblxuZnVuY3Rpb24gYzh5VGl0bGVEZWNvcmF0b3IoXG4gICRxLFxuICAkZGVsZWdhdGUsXG4gICRpbmplY3RvcixcbiAgJHJvb3RTY29wZSxcbiAgJGxvY2F0aW9uLFxuICAkdGVtcGxhdGVDYWNoZSxcbiAgJGNvbXBpbGUsXG4gIGM4eUhlYWRlclNlcnZpY2Vcbikge1xuICAnbmdJbmplY3QnO1xuXG4gICRkZWxlZ2F0ZS5jaGFuZ2VUaXRsZSA9IGNoYW5nZVRpdGxlO1xuICAkZGVsZWdhdGUuc2V0VGl0bGVFbGVtZW50ID0gc2V0VGl0bGVFbGVtZW50O1xuXG4gICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsICgpID0+IHtcbiAgICBjaGFuZ2VUaXRsZSh7fSk7XG4gIH0pO1xuXG4gICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdWNjZXNzJywgKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgdGl0bGUgPSAkZGVsZWdhdGUuZ2V0KCRsb2NhdGlvbi5wYXRoKCkpO1xuICAgIGlmICh0aXRsZSkge1xuICAgICAgY29uc3QgdGl0bGVEYXRhID0gJHEud2hlbih0aXRsZS5kYXRhID8gJGluamVjdG9yLmludm9rZSh0aXRsZS5kYXRhKSA6IHt9KTtcbiAgICAgIHRpdGxlRGF0YS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGVtcGxhdGVVcmwgfSA9IGRhdGE7XG4gICAgICAgIGlmICh0ZW1wbGF0ZVVybCkge1xuICAgICAgICAgIGNvbnN0IHRlbXBsYXRlID0gJHRlbXBsYXRlQ2FjaGUuZ2V0KHRlbXBsYXRlVXJsKTtcbiAgICAgICAgICBzZXRUaXRsZUVsZW1lbnQoJGNvbXBpbGUodGVtcGxhdGUpKGV2ZW50LnRhcmdldFNjb3BlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbmdlVGl0bGUoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgZnVuY3Rpb24gY2hhbmdlVGl0bGUobmV3VGl0bGUpIHtcbiAgICAkcS53aGVuKG5ld1RpdGxlKS50aGVuKCh0aXRsZSkgPT4gY2hhbmdlVGl0bGVJbkFuZ3VsYXIodHJhbnNsYXRlKHRpdGxlKSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gdHJhbnNsYXRlKHt0aXRsZSwgc3VidGl0bGV9KSB7XG4gICAgY29uc3QgaXNvbGF0ZWRTY29wZSA9ICRyb290U2NvcGUuJG5ldyh0cnVlKTtcbiAgICBpc29sYXRlZFNjb3BlLnRpdGxlID0gdGl0bGU7XG4gICAgaXNvbGF0ZWRTY29wZS5zdWJ0aXRsZSA9IHN1YnRpdGxlO1xuICAgIHJldHVybiAkY29tcGlsZShhbmd1bGFyLmVsZW1lbnQoYFxuICAgICAgPGgxIGNsYXNzPVwidGV4dC10cnVuY2F0ZVwiPnt7dGl0bGUgfCB0cmFuc2xhdGV9fVxuICAgICAgPHNtYWxsPnt7IHN1YnRpdGxlIHwgdHJhbnNsYXRlIH19PC9zbWFsbD48L2gxPlxuICAgIGApKShpc29sYXRlZFNjb3BlKVswXTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoYW5nZVRpdGxlSW5Bbmd1bGFyKGRvbUVsZW1lbnQpIHtcbiAgICBjOHlIZWFkZXJTZXJ2aWNlLmNoYW5nZVRpdGxlKGRvbUVsZW1lbnQpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0VGl0bGVFbGVtZW50KCRlbGVtZW50KSB7XG4gICAgJGVsZW1lbnQuc2hvdygpO1xuICAgIGNoYW5nZVRpdGxlSW5Bbmd1bGFyKCRlbGVtZW50WzBdKTtcbiAgfVxuXG4gIHJldHVybiAkZGVsZWdhdGU7XG59XG5cbmV4cG9ydCB7IGM4eVRpdGxlRGVjb3JhdG9yIH07XG4iXX0=