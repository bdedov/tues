import * as angular from 'angular';
function c8yTitleDecorator($q, $delegate, $injector, $rootScope, $location, $templateCache, $compile, c8yHeaderService) {
    'ngInject';
    $delegate.changeTitle = changeTitle;
    $delegate.setTitleElement = setTitleElement;
    $rootScope.$on('$routeChangeStart', function () {
        changeTitle({});
    });
    $rootScope.$on('$routeChangeSuccess', function (event) {
        var title = $delegate.get($location.path());
        if (title) {
            var titleData = $q.when(title.data ? $injector.invoke(title.data) : {});
            titleData.then(function (data) {
                var templateUrl = data.templateUrl;
                if (templateUrl) {
                    var template = $templateCache.get(templateUrl);
                    setTitleElement($compile(template)(event.targetScope));
                }
                else {
                    changeTitle(data);
                }
            });
        }
    });
    function changeTitle(newTitle) {
        $q.when(newTitle).then(function (title) { return changeTitleInAngular(translate(title)); });
    }
    function translate(_a) {
        var title = _a.title, subtitle = _a.subtitle;
        var isolatedScope = $rootScope.$new(true);
        isolatedScope.title = title;
        isolatedScope.subtitle = subtitle;
        return $compile(angular.element("\n      <h1 class=\"text-truncate\">{{title | translate}}\n      <small>{{ subtitle | translate }}</small></h1>\n    "))(isolatedScope)[0];
    }
    function changeTitleInAngular(domElement) {
        c8yHeaderService.changeTitle(domElement);
    }
    function setTitleElement($element) {
        $element.show();
        changeTitleInAngular($element[0]);
    }
    return $delegate;
}
export { c8yTitleDecorator };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGl0bGUuZGVjb3JhdG9yLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy91cGdyYWRlLyIsInNvdXJjZXMiOlsibmcxL3RpdGxlLmRlY29yYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssT0FBTyxNQUFNLFNBQVMsQ0FBQztBQUVuQyxTQUFTLGlCQUFpQixDQUN4QixFQUFFLEVBQ0YsU0FBUyxFQUNULFNBQVMsRUFDVCxVQUFVLEVBQ1YsU0FBUyxFQUNULGNBQWMsRUFDZCxRQUFRLEVBQ1IsZ0JBQWdCO0lBRWhCLFVBQVUsQ0FBQztJQUVYLFNBQVMsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQ3BDLFNBQVMsQ0FBQyxlQUFlLEdBQUcsZUFBZSxDQUFDO0lBRTVDLFVBQVUsQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUU7UUFDbEMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2xCLENBQUMsQ0FBQyxDQUFDO0lBRUgsVUFBVSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxVQUFDLEtBQUs7UUFDMUMsSUFBTSxLQUFLLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUM5QyxJQUFJLEtBQUssRUFBRTtZQUNULElBQU0sU0FBUyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO2dCQUNWLElBQUEsOEJBQVcsQ0FBVTtnQkFDN0IsSUFBSSxXQUFXLEVBQUU7b0JBQ2YsSUFBTSxRQUFRLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFDakQsZUFBZSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztpQkFDeEQ7cUJBQU07b0JBQ0wsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUNuQjtZQUNILENBQUMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsV0FBVyxDQUFDLFFBQVE7UUFDM0IsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxLQUFLLElBQUssT0FBQSxvQkFBb0IsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBdEMsQ0FBc0MsQ0FBQyxDQUFDO0lBQzVFLENBQUM7SUFFRCxTQUFTLFNBQVMsQ0FBQyxFQUFpQjtZQUFoQixnQkFBSyxFQUFFLHNCQUFRO1FBQ2pDLElBQU0sYUFBYSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDNUMsYUFBYSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDNUIsYUFBYSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDbEMsT0FBTyxRQUFRLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyx1SEFHL0IsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUVELFNBQVMsb0JBQW9CLENBQUMsVUFBVTtRQUN0QyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVELFNBQVMsZUFBZSxDQUFDLFFBQVE7UUFDL0IsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ2hCLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCxPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDO0FBRUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuXG5mdW5jdGlvbiBjOHlUaXRsZURlY29yYXRvcihcbiAgJHEsXG4gICRkZWxlZ2F0ZSxcbiAgJGluamVjdG9yLFxuICAkcm9vdFNjb3BlLFxuICAkbG9jYXRpb24sXG4gICR0ZW1wbGF0ZUNhY2hlLFxuICAkY29tcGlsZSxcbiAgYzh5SGVhZGVyU2VydmljZVxuKSB7XG4gICduZ0luamVjdCc7XG5cbiAgJGRlbGVnYXRlLmNoYW5nZVRpdGxlID0gY2hhbmdlVGl0bGU7XG4gICRkZWxlZ2F0ZS5zZXRUaXRsZUVsZW1lbnQgPSBzZXRUaXRsZUVsZW1lbnQ7XG5cbiAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgKCkgPT4ge1xuICAgIGNoYW5nZVRpdGxlKHt9KTtcbiAgfSk7XG5cbiAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCAoZXZlbnQpID0+IHtcbiAgICBjb25zdCB0aXRsZSA9ICRkZWxlZ2F0ZS5nZXQoJGxvY2F0aW9uLnBhdGgoKSk7XG4gICAgaWYgKHRpdGxlKSB7XG4gICAgICBjb25zdCB0aXRsZURhdGEgPSAkcS53aGVuKHRpdGxlLmRhdGEgPyAkaW5qZWN0b3IuaW52b2tlKHRpdGxlLmRhdGEpIDoge30pO1xuICAgICAgdGl0bGVEYXRhLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgY29uc3QgeyB0ZW1wbGF0ZVVybCB9ID0gZGF0YTtcbiAgICAgICAgaWYgKHRlbXBsYXRlVXJsKSB7XG4gICAgICAgICAgY29uc3QgdGVtcGxhdGUgPSAkdGVtcGxhdGVDYWNoZS5nZXQodGVtcGxhdGVVcmwpO1xuICAgICAgICAgIHNldFRpdGxlRWxlbWVudCgkY29tcGlsZSh0ZW1wbGF0ZSkoZXZlbnQudGFyZ2V0U2NvcGUpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFuZ2VUaXRsZShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICBmdW5jdGlvbiBjaGFuZ2VUaXRsZShuZXdUaXRsZSkge1xuICAgICRxLndoZW4obmV3VGl0bGUpLnRoZW4oKHRpdGxlKSA9PiBjaGFuZ2VUaXRsZUluQW5ndWxhcih0cmFuc2xhdGUodGl0bGUpKSk7XG4gIH1cblxuICBmdW5jdGlvbiB0cmFuc2xhdGUoe3RpdGxlLCBzdWJ0aXRsZX0pIHtcbiAgICBjb25zdCBpc29sYXRlZFNjb3BlID0gJHJvb3RTY29wZS4kbmV3KHRydWUpO1xuICAgIGlzb2xhdGVkU2NvcGUudGl0bGUgPSB0aXRsZTtcbiAgICBpc29sYXRlZFNjb3BlLnN1YnRpdGxlID0gc3VidGl0bGU7XG4gICAgcmV0dXJuICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChgXG4gICAgICA8aDEgY2xhc3M9XCJ0ZXh0LXRydW5jYXRlXCI+e3t0aXRsZSB8IHRyYW5zbGF0ZX19XG4gICAgICA8c21hbGw+e3sgc3VidGl0bGUgfCB0cmFuc2xhdGUgfX08L3NtYWxsPjwvaDE+XG4gICAgYCkpKGlzb2xhdGVkU2NvcGUpWzBdO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hhbmdlVGl0bGVJbkFuZ3VsYXIoZG9tRWxlbWVudCkge1xuICAgIGM4eUhlYWRlclNlcnZpY2UuY2hhbmdlVGl0bGUoZG9tRWxlbWVudCk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRUaXRsZUVsZW1lbnQoJGVsZW1lbnQpIHtcbiAgICAkZWxlbWVudC5zaG93KCk7XG4gICAgY2hhbmdlVGl0bGVJbkFuZ3VsYXIoJGVsZW1lbnRbMF0pO1xuICB9XG5cbiAgcmV0dXJuICRkZWxlZ2F0ZTtcbn1cblxuZXhwb3J0IHsgYzh5VGl0bGVEZWNvcmF0b3IgfTtcbiJdfQ==