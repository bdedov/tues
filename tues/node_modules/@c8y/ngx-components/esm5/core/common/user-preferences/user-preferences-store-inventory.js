import * as tslib_1 from "tslib";
var UserPreferencesStorageInventory = /** @class */ (function () {
    function UserPreferencesStorageInventory(inventory) {
        this.inventory = inventory;
        this.TYPE = 'c8y_UserPreference';
    }
    UserPreferencesStorageInventory.prototype.get = function (key) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.inventory.list({ fragmentType: key })];
                    case 1:
                        data = (_a.sent()).data;
                        return [2 /*return*/, data.length ? data[0][key] : undefined];
                }
            });
        });
    };
    UserPreferencesStorageInventory.prototype.set = function (key, value) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var data, updateMo, out;
            var _a;
            return tslib_1.__generator(this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.inventory.list({ fragmentType: key })];
                    case 1:
                        data = (_b.sent()).data;
                        updateMo = (_a = {}, _a[key] = value, _a.type = this.TYPE, _a);
                        if (data.length) {
                            updateMo.id = data[0].id;
                            out = this.inventory.update(updateMo);
                        }
                        else {
                            out = this.inventory.create(updateMo);
                        }
                        return [2 /*return*/, out];
                }
            });
        });
    };
    return UserPreferencesStorageInventory;
}());
export { UserPreferencesStorageInventory };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1wcmVmZXJlbmNlcy1zdG9yZS1pbnZlbnRvcnkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYzh5L25neC1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsiY29yZS9jb21tb24vdXNlci1wcmVmZXJlbmNlcy91c2VyLXByZWZlcmVuY2VzLXN0b3JlLWludmVudG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUE7SUFHRSx5Q0FDVSxTQUEyQjtRQUEzQixjQUFTLEdBQVQsU0FBUyxDQUFrQjtRQUhyQyxTQUFJLEdBQUcsb0JBQW9CLENBQUM7SUFJekIsQ0FBQztJQUVFLDZDQUFHLEdBQVQsVUFBVSxHQUFHOzs7Ozs0QkFDTSxxQkFBTSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFDLFlBQVksRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUFBOzt3QkFBdkQsSUFBSSxHQUFLLENBQUEsU0FBOEMsQ0FBQSxLQUFuRDt3QkFDWixzQkFBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBQzs7OztLQUMvQztJQUVLLDZDQUFHLEdBQVQsVUFBVSxHQUFHLEVBQUUsS0FBSzs7Ozs7OzRCQUNELHFCQUFNLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUMsWUFBWSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQUE7O3dCQUF2RCxJQUFJLEdBQUssQ0FBQSxTQUE4QyxDQUFBLEtBQW5EO3dCQUNOLFFBQVEsYUFBUyxHQUFDLEdBQUcsSUFBRyxLQUFLLEVBQUUsT0FBSSxHQUFFLElBQUksQ0FBQyxJQUFJLEtBQUMsQ0FBQzt3QkFHdEQsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFOzRCQUNmLFFBQVEsQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQzs0QkFDekIsR0FBRyxHQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3lCQUN4Qzs2QkFBTTs0QkFDTCxHQUFHLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7eUJBQ3ZDO3dCQUNELHNCQUFPLEdBQUcsRUFBQzs7OztLQUNaO0lBQ0gsc0NBQUM7QUFBRCxDQUFDLEFBekJELElBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW52ZW50b3J5U2VydmljZSB9IGZyb20gJ0BjOHkvY2xpZW50JztcblxuZXhwb3J0IGNsYXNzIFVzZXJQcmVmZXJlbmNlc1N0b3JhZ2VJbnZlbnRvcnkge1xuICBUWVBFID0gJ2M4eV9Vc2VyUHJlZmVyZW5jZSc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBpbnZlbnRvcnk6IEludmVudG9yeVNlcnZpY2VcbiAgKSB7fVxuXG4gIGFzeW5jIGdldChrZXkpIHtcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuaW52ZW50b3J5Lmxpc3Qoe2ZyYWdtZW50VHlwZToga2V5fSk7XG4gICAgcmV0dXJuIGRhdGEubGVuZ3RoID8gZGF0YVswXVtrZXldIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgYXN5bmMgc2V0KGtleSwgdmFsdWUpIHtcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuaW52ZW50b3J5Lmxpc3Qoe2ZyYWdtZW50VHlwZToga2V5fSk7XG4gICAgY29uc3QgdXBkYXRlTW86IGFueSA9IHtba2V5XTogdmFsdWUsIHR5cGU6IHRoaXMuVFlQRX07XG4gICAgbGV0IG91dDtcblxuICAgIGlmIChkYXRhLmxlbmd0aCkge1xuICAgICAgdXBkYXRlTW8uaWQgPSBkYXRhWzBdLmlkO1xuICAgICAgb3V0ID0gIHRoaXMuaW52ZW50b3J5LnVwZGF0ZSh1cGRhdGVNbyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG91dCA9IHRoaXMuaW52ZW50b3J5LmNyZWF0ZSh1cGRhdGVNbyk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG4gIH1cbn1cbiJdfQ==