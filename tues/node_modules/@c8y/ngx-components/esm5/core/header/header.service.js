import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { distinctUntilChanged, map, combineLatest, delay, debounceTime } from 'rxjs/operators';
import { OptionsService } from '../common/options.service';
import { StateService } from '../common/state-service.abstract';
import { NavigatorService } from '../navigator/navigator.service';
import * as i0 from "@angular/core";
import * as i1 from "../navigator/navigator.service";
import * as i2 from "../common/options.service";
/**
 * A service which defines header functions.
 */
var HeaderService = /** @class */ (function (_super) {
    tslib_1.__extends(HeaderService, _super);
    function HeaderService(navigatorService, options) {
        var _this = _super.call(this) || this;
        _this.navigatorService = navigatorService;
        _this.options = options;
        _this.DELAY_TO_AVOID_FLICKERING_ON_ASYNC_NODES = 1000;
        _this.hasItemsInNavigator$ = _this.navigatorService.items$.pipe(delay(_this.DELAY_TO_AVOID_FLICKERING_ON_ASYNC_NODES), map(function (_a) {
            var length = _a.length;
            return !!length;
        }), distinctUntilChanged());
        _this.state$ = new BehaviorSubject({
            title: undefined,
            nav: {
                open: false
            }
        });
        _this.title = undefined;
        _this.header$ = _this.map(function (header) { return header; });
        _this.navigatorOpen$ = _this.map(function (_a) {
            var nav = _a.nav;
            return nav.open;
        }).pipe(combineLatest(_this.hasItemsInNavigator$), map(function (_a) {
            var _b = tslib_1.__read(_a, 2), open = _b[0], hasItems = _b[1];
            return open && hasItems;
        }));
        var titleReference = document.querySelector('title');
        _this.title = {
            elementRef: titleReference,
            originalValue: titleReference && titleReference.innerText
        };
        return _this;
    }
    Object.defineProperty(HeaderService.prototype, "state", {
        get: function () {
            return this.state$.value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HeaderService.prototype, "navigatorHiddenOnStartup", {
        get: function () {
            return this.options.hideNavigator;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HeaderService.prototype, "largeWidth", {
        get: function () {
            return document.documentElement.clientWidth > 1200;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HeaderService.prototype, "shouldToggle", {
        get: function () {
            return this.largeWidth && !this.navigatorHiddenOnStartup && !this.state.nav.open;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Toggles the navigator open status.
     */
    HeaderService.prototype.toggleNavigator = function () {
        this.state.nav.open = !this.state.nav.open;
        this.emitNewState();
    };
    /**
     * Force to close the navigator.
     */
    HeaderService.prototype.closeNavigator = function () {
        this.state.nav.open = false;
        this.emitNewState();
    };
    /**
     * Configures navigation options.
     * @param config Object with the properties:
     * - open: Boolean
     */
    HeaderService.prototype.configNavigator = function (config) {
        if (config === void 0) { config = {}; }
        this.state.nav = Object.assign(this.state.nav, config);
        this.emitNewState();
    };
    /**
     * Change the application title.
     * @param newTitle The new title of the application.
     */
    HeaderService.prototype.changeTitle = function (newTitle, pageTitleUpdate) {
        if (pageTitleUpdate === void 0) { pageTitleUpdate = true; }
        this.state.title = newTitle;
        this.state.pageTitleUpdate = pageTitleUpdate;
        this.emitNewState();
    };
    /**
     * Change the page title.
     * @param newTitle The new title of the page.
     */
    HeaderService.prototype.changePageTitle = function (newTitle) {
        this.title.elementRef.innerText = newTitle
            ? newTitle + " / " + this.title.originalValue
            : "" + this.title.originalValue;
    };
    /**
     * This methods checks if the navigator toggles on startup
     * or if an item is added to the navigator node.
     * Delay of 300ms is intended for animation purpose.
     */
    HeaderService.prototype.verifyIfNavOpen = function () {
        var _this = this;
        this.hasItemsInNavigator$
            .pipe(debounceTime(300))
            .subscribe(function (hasItems) { return hasItems && _this.shouldToggle && _this.toggleNavigator(); });
    };
    HeaderService.prototype.shouldShowBreadcrumbs = function () {
        return this.options.breadcrumbs;
    };
    HeaderService.ctorParameters = function () { return [
        { type: NavigatorService },
        { type: OptionsService }
    ]; };
    HeaderService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function HeaderService_Factory() { return new HeaderService(i0.ɵɵinject(i1.NavigatorService), i0.ɵɵinject(i2.OptionsService)); }, token: HeaderService, providedIn: "root" });
    HeaderService = tslib_1.__decorate([
        Injectable({
            providedIn: 'root'
        })
    ], HeaderService);
    return HeaderService;
}(StateService));
export { HeaderService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYzh5L25neC1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsiY29yZS9oZWFkZXIvaGVhZGVyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLGVBQWUsRUFBa0IsTUFBTSxNQUFNLENBQUM7QUFDdkQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxhQUFhLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQy9GLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDaEUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7Ozs7QUFHbEU7O0dBRUc7QUFJSDtJQUFtQyx5Q0FBWTtJQW9CN0MsdUJBQW9CLGdCQUFrQyxFQUFVLE9BQXVCO1FBQXZGLFlBQ0UsaUJBQU8sU0FXUjtRQVptQixzQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQVUsYUFBTyxHQUFQLE9BQU8sQ0FBZ0I7UUFqQjlFLDhDQUF3QyxHQUFHLElBQUksQ0FBQztRQUV6RCwwQkFBb0IsR0FBRyxLQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDdEQsS0FBSyxDQUFDLEtBQUksQ0FBQyx3Q0FBd0MsQ0FBQyxFQUNwRCxHQUFHLENBQUMsVUFBQyxFQUFVO2dCQUFSLGtCQUFNO1lBQU8sT0FBQSxDQUFDLENBQUMsTUFBTTtRQUFSLENBQVEsQ0FBQyxFQUM3QixvQkFBb0IsRUFBRSxDQUN2QixDQUFDO1FBRUYsWUFBTSxHQUE0QixJQUFJLGVBQWUsQ0FBUztZQUM1RCxLQUFLLEVBQUUsU0FBUztZQUNoQixHQUFHLEVBQUU7Z0JBQ0gsSUFBSSxF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QUssQ0FBQyxhQUFlO1lBQzdDLENBQUMsQ0FBQyxLQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBZSxDQUFDO0lBQ3BDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsdUNBQWUsR0FBZjtRQUFBLGlCQUlDO1FBSEMsSUFBSSxDQUFDLG9CQUFvQjthQUN0QixJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3ZCLFNBQVMsQ0FBQyxVQUFBLFFBQVEsSUFBSSxPQUFBLFFBQVEsSUFBSSxLQUFJLENBQUMsWUFBWSxJQUFJLEtBQUksQ0FBQyxlQUFlLEVBQUUsRUFBdkQsQ0FBdUQsQ0FBQyxDQUFDO0lBQ3BGLENBQUM7SUFFRCw2Q0FBcUIsR0FBckI7UUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO0lBQ2xDLENBQUM7O2dCQTFGcUMsZ0JBQWdCO2dCQUFtQixjQUFjOzs7SUFwQjVFLGFBQWE7UUFIekIsVUFBVSxDQUFDO1lBQ1YsVUFBVSxFQUFFLE1BQU07U0FDbkIsQ0FBQztPQUNXLGFBQWEsQ0ErR3pCO3dCQTdIRDtDQTZIQyxBQS9HRCxDQUFtQyxZQUFZLEdBK0c5QztTQS9HWSxhQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCwgY29tYmluZUxhdGVzdCwgZGVsYXksIGRlYm91bmNlVGltZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE9wdGlvbnNTZXJ2aWNlIH0gZnJvbSAnLi4vY29tbW9uL29wdGlvbnMuc2VydmljZSc7XG5pbXBvcnQgeyBTdGF0ZVNlcnZpY2UgfSBmcm9tICcuLi9jb21tb24vc3RhdGUtc2VydmljZS5hYnN0cmFjdCc7XG5pbXBvcnQgeyBOYXZpZ2F0b3JTZXJ2aWNlIH0gZnJvbSAnLi4vbmF2aWdhdG9yL25hdmlnYXRvci5zZXJ2aWNlJztcbmltcG9ydCB7IEhlYWRlciB9IGZyb20gJy4vaGVhZGVyLm1vZGVsJztcblxuLyoqXG4gKiBBIHNlcnZpY2Ugd2hpY2ggZGVmaW5lcyBoZWFkZXIgZnVuY3Rpb25zLlxuICovXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBIZWFkZXJTZXJ2aWNlIGV4dGVuZHMgU3RhdGVTZXJ2aWNlIHtcbiAgaGVhZGVyJDogT2JzZXJ2YWJsZTxIZWFkZXI+O1xuICBuYXZpZ2F0b3JPcGVuJDogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgcmVhZG9ubHkgREVMQVlfVE9fQVZPSURfRkxJQ0tFUklOR19PTl9BU1lOQ19OT0RFUyA9IDEwMDA7XG5cbiAgaGFzSXRlbXNJbk5hdmlnYXRvciQgPSB0aGlzLm5hdmlnYXRvclNlcnZpY2UuaXRlbXMkLnBpcGUoXG4gICAgZGVsYXkodGhpcy5ERUxBWV9UT19BVk9JRF9GTElDS0VSSU5HX09OX0FTWU5DX05PREVTKSxcbiAgICBtYXAoKHsgbGVuZ3RoIH0pID0+ICEhbGVuZ3RoKSxcbiAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpXG4gICk7XG5cbiAgc3RhdGUkOiBCZWhhdmlvclN1YmplY3Q8SGVhZGVyPiA9IG5ldyBCZWhhdmlvclN1YmplY3Q8SGVhZGVyPih7XG4gICAgdGl0bGU6IHVuZGVmaW5lZCxcbiAgICBuYXY6IHtcbiAgICAgIG9wZW46IGZhbHNlXG4gICAgfVxuICB9KTtcblxuICB0aXRsZSA9IHVuZGVmaW5lZDtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG5hdmlnYXRvclNlcnZpY2U6IE5hdmlnYXRvclNlcnZpY2UsIHByaXZhdGUgb3B0aW9uczogT3B0aW9uc1NlcnZpY2UpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuaGVhZGVyJCA9IHRoaXMubWFwKChoZWFkZXI6IEhlYWRlcikgPT4gaGVhZGVyKTtcbiAgICB0aGlzLm5hdmlnYXRvck9wZW4kID0gdGhpcy5tYXAoKHsgbmF2IH0pID0+IG5hdi5vcGVuKS5waXBlKFxuICAgICAgY29tYmluZUxhdGVzdCh0aGlzLmhhc0l0ZW1zSW5OYXZpZ2F0b3IkKSxcbiAgICAgIG1hcCgoW29wZW4sIGhhc0l0ZW1zXSkgPT4gb3BlbiAmJiBoYXNJdGVtcylcbiAgICApO1xuICAgIGNvbnN0IHRpdGxlUmVmZXJlbmNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGl0bGUnKTtcbiAgICB0aGlzLnRpdGxlID0ge1xuICAgICAgZWxlbWVudFJlZjogdGl0bGVSZWZlcmVuY2UsXG4gICAgICBvcmlnaW5hbFZhbHVlOiB0aXRsZVJlZmVyZW5jZSAmJiB0aXRsZVJlZmVyZW5jZS5pbm5lclRleHRcbiAgICB9O1xuICB9XG5cbiAgZ2V0IHN0YXRlKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlJC52YWx1ZTtcbiAgfVxuXG4gIGdldCBuYXZpZ2F0b3JIaWRkZW5PblN0YXJ0dXAoKSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5oaWRlTmF2aWdhdG9yO1xuICB9XG5cbiAgZ2V0IGxhcmdlV2lkdGgoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA+IDEyMDA7XG4gIH1cblxuICBnZXQgc2hvdWxkVG9nZ2xlKCkge1xuICAgIHJldHVybiB0aGlzLmxhcmdlV2lkdGggJiYgIXRoaXMubmF2aWdhdG9ySGlkZGVuT25TdGFydHVwICYmICF0aGlzLnN0YXRlLm5hdi5vcGVuO1xuICB9XG5cbiAgLyoqXG4gICAqIFRvZ2dsZXMgdGhlIG5hdmlnYXRvciBvcGVuIHN0YXR1cy5cbiAgICovXG4gIHRvZ2dsZU5hdmlnYXRvcigpIHtcbiAgICB0aGlzLnN0YXRlLm5hdi5vcGVuID0gIXRoaXMuc3RhdGUubmF2Lm9wZW47XG4gICAgdGhpcy5lbWl0TmV3U3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JjZSB0byBjbG9zZSB0aGUgbmF2aWdhdG9yLlxuICAgKi9cbiAgY2xvc2VOYXZpZ2F0b3IoKSB7XG4gICAgdGhpcy5zdGF0ZS5uYXYub3BlbiA9IGZhbHNlO1xuICAgIHRoaXMuZW1pdE5ld1N0YXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQ29uZmlndXJlcyBuYXZpZ2F0aW9uIG9wdGlvbnMuXG4gICAqIEBwYXJhbSBjb25maWcgT2JqZWN0IHdpdGggdGhlIHByb3BlcnRpZXM6XG4gICAqIC0gb3BlbjogQm9vbGVhblxuICAgKi9cbiAgY29uZmlnTmF2aWdhdG9yKGNvbmZpZzogYW55ID0ge30pIHtcbiAgICB0aGlzLnN0YXRlLm5hdiA9IE9iamVjdC5hc3NpZ24odGhpcy5zdGF0ZS5uYXYsIGNvbmZpZyk7XG4gICAgdGhpcy5lbWl0TmV3U3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGFuZ2UgdGhlIGFwcGxpY2F0aW9uIHRpdGxlLlxuICAgKiBAcGFyYW0gbmV3VGl0bGUgVGhlIG5ldyB0aXRsZSBvZiB0aGUgYXBwbGljYXRpb24uXG4gICAqL1xuICBjaGFuZ2VUaXRsZShuZXdUaXRsZT86IGFueSwgcGFnZVRpdGxlVXBkYXRlOiBib29sZWFuID0gdHJ1ZSkge1xuICAgIHRoaXMuc3RhdGUudGl0bGUgPSBuZXdUaXRsZTtcbiAgICB0aGlzLnN0YXRlLnBhZ2VUaXRsZVVwZGF0ZSA9IHBhZ2VUaXRsZVVwZGF0ZTtcblxuICAgIHRoaXMuZW1pdE5ld1N0YXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hhbmdlIHRoZSBwYWdlIHRpdGxlLlxuICAgKiBAcGFyYW0gbmV3VGl0bGUgVGhlIG5ldyB0aXRsZSBvZiB0aGUgcGFnZS5cbiAgICovXG4gIGNoYW5nZVBhZ2VUaXRsZShuZXdUaXRsZT86IHN0cmluZykge1xuICAgIHRoaXMudGl0bGUuZWxlbWVudFJlZi5pbm5lclRleHQgPSBuZXdUaXRsZVxuICAgICAgPyBgJHtuZXdUaXRsZX0gLyAke3RoaXMudGl0bGUub3JpZ2luYWxWYWx1ZX1gXG4gICAgICA6IGAke3RoaXMudGl0bGUub3JpZ2luYWxWYWx1ZX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kcyBjaGVja3MgaWYgdGhlIG5hdmlnYXRvciB0b2dnbGVzIG9uIHN0YXJ0dXBcbiAgICogb3IgaWYgYW4gaXRlbSBpcyBhZGRlZCB0byB0aGUgbmF2aWdhdG9yIG5vZGUuXG4gICAqIERlbGF5IG9mIDMwMG1zIGlzIGludGVuZGVkIGZvciBhbmltYXRpb24gcHVycG9zZS5cbiAgICovXG4gIHZlcmlmeUlmTmF2T3BlbigpIHtcbiAgICB0aGlzLmhhc0l0ZW1zSW5OYXZpZ2F0b3IkXG4gICAgICAucGlwZShkZWJvdW5jZVRpbWUoMzAwKSlcbiAgICAgIC5zdWJzY3JpYmUoaGFzSXRlbXMgPT4gaGFzSXRlbXMgJiYgdGhpcy5zaG91bGRUb2dnbGUgJiYgdGhpcy50b2dnbGVOYXZpZ2F0b3IoKSk7XG4gIH1cblxuICBzaG91bGRTaG93QnJlYWRjcnVtYnMoKSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5icmVhZGNydW1icztcbiAgfVxufVxuIl19