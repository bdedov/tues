<div class="card" ng-controller="deviceDetailSoftwareVPCtrl" ng-show="visible()">
  <div class="card-header">
    <h4 class="card-title" translate>Software</h4>
  </div>
  <hr />
  <div class="card-block">
    <div class="alert alert-warning" ng-show="installedSoftware.length == 0" translate>
      No software available on the device
    </div>

    <table class="table table-condensed" ng-show="installedSoftware.length">
      <thead>
        <th translate>Name</th>
        <th translate>Version</th>
        <th></th>
      </thead>
      <tbody>
        <tr ng-repeat="soft in installedSoftware | orderBy:['name','version']">
          <td ng-bind="soft.name"></td>
          <td ng-bind="soft.version"></td>
          <td style="text-align:right;">
            <div ng-show="actionable()">
              <a
                href=""
                class="btn btn-xs btn-danger showOnHover"
                title="{{ 'Remove`software`' | translate }}"
                ng-click="removeSoftware(soft)"
              >
                <i c8y-icon="times"></i>
              </a>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <button
      title="{{ 'Submit operation' | translate }}"
      type="button"
      class="btn btn-success"
      ng-show="hasChanges"
      ng-click="sendOperation()"
      translate
    >
      Submit operation
    </button>
    <button
      title="{{ 'Reset changes' | translate }}"
      type="button"
      class="btn btn-danger"
      ng-show="hasChanges"
      ng-click="resetChanges()"
      translate
    >
      Reset changes
    </button>
  </div>

  <form role="form" class="bg-gray-white" name="newOptionForm" ng-if="actionable()">
    <div class="card-block">
      <div class="legend form-block" translate>Software to install</div>
      <div class="form-group">
        <ui-select ng-model="newSoftware.selected" class="form-control" append-to-body="true">
          <ui-select-match
            placeholder="{{ 'Select a software from the list.' | translate }}"
            title="{{ $select.selected.name }} &ndash; {{ $select.selected.version }}"
          >
            {{ $select.selected.name }} &ndash; {{ $select.selected.version }}
          </ui-select-match>
          <ui-select-choices
            repeat="s in softwares | orderBy:['name','version'] | filter: $select.search"
          >
            <span title="{{ s.name }} &ndash; {{ s.version }}">
              {{ s.name }} &ndash; {{ s.version }}
            </span>
          </ui-select-choices>
        </ui-select>
      </div>
      <button
        title="{{ 'Install' | translate }}"
        type="button"
        class="btn btn-primary"
        ng-disabled="!newSoftware.selected"
        ng-click="installSoftware(newSoftware.selected); newSoftware.selected = undefined;"
        translate
      >
        Install
      </button>
    </div>
  </form>
</div>
