"use strict";!function(){function t(t,e,u,r,n,c,i,o){var s=[];function a(t){return _.filter(t,function(t){return!t.hideFromList})}function l(t){var n,e=_.keys(c);return 0===e.length?t:_.filter(t,function(t){return!!(t.contexts&&(n=_.keys(t.contexts),0<_.intersection(e,n).length))})}function f(t){return _.filter(t,function(t){return!i||i(t)})}function h(t){t.forEach(function(t){s.push(t)})}function m(){1===s.length&&s[0]._active&&v(s[0])}function v(t){var n;return t._active&&(n=r.createInstanceWithUI(t,function(n){var e={},t=n.contexts&&_.intersection(_.keys(c),_.keys(n.contexts))||[];return _.forEach(t,function(t){var i={obj:c[t]},o={rule:e};_.forEach(n.contexts[t],function(t,n){var e=u("obj.".concat(n)),r=u("rule.".concat(t)),c=e(i);r.assign(o,c)})}),_.assign(e,o)}(t)).then(e.close)),n}t.ruleTemplates=s,t.cancel=function(){e.dismiss()},t.createInstance=v,n.list().then(a).then(l).then(f).then(h).then(m)}t.$inject=["$scope","$uibModalInstance","$parse","smartRulesSvc","smartRuleTemplatesSvc","context","ruleTemplatesFilterFn","ruleInitialObj"],angular.module("c8y.smartRules").controller("SmartRuleAddCtrl",t)}();