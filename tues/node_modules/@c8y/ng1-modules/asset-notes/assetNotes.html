<div ng-if="!vm.editable" style="height:100%;">
  <div class="flex-row wrap">
    <span c8y-icon="c8y-notification" class="c8y-icon c8y-icon-duocolor asset-notes-icon"></span>
    <div class="asset-notes-content">
      <c8y-rectangle-spinner class="spinner-inline" ng-show="!vm.notes"> </c8y-rectangle-spinner>

      <div ng-if="vm.notes && !vm.notes.htmlContent">
        {{ 'No notes yet.' | translate }}
        <c8y-if-allowed admin-mos="[vm.config.context]">
          <a title="{{ 'Edit' | translate }}" class="small" href="" ng-click="vm.edit()">
            <i c8y-icon="pencil"></i> {{ 'Edit' | translate }}
          </a>
        </c8y-if-allowed>
      </div>

      <div ng-if="vm.notes && vm.notes.htmlContent" class="text-break-word asset-notes-body">
        <span ng-bind-html="vm.notes.htmlContent"></span>
        <c8y-if-allowed admin-mos="[vm.config.context]">
          <a title="{{ 'Edit' | translate }}" class="small" href="" ng-click="vm.edit()">
            <i c8y-icon="pencil"></i> {{ 'Edit' | translate }}
          </a>
        </c8y-if-allowed>
      </div>

      <div class="asset-notes-footer top-m-sm">
        <small class="text-muted">
          <em ng-if="vm.notes.lastUpdated" translate>
            {{ vm.notes.lastUpdated | absoluteDate }} by {{ vm.notes.user }}
          </em>
        </small>
      </div>
    </div>
  </div>
</div>

<div ng-if="vm.editable" style="height: 100%;">
  <div class="input-group input-group-editable" style="height:100%;">
    <textarea
      class="form-control"
      style="resize: none; height: 100%;"
      ng-model="vm.editedNotes.htmlContent"
      c8y-code-editor
    >
    </textarea>
    <div class="input-group-btn">
      <button
        type="button"
        class="btn btn-clean text-success"
        ng-click="vm.save()"
        title="{{ 'Save' | translate }}"
      >
        <i c8y-icon="check"></i>
      </button>
    </div>
    <div class="input-group-btn">
      <button
        type="button"
        class="btn btn-clean text-danger"
        ng-click="vm.cancel()"
        title="{{ 'Cancel' | translate }}"
      >
        <i c8y-icon="times"></i>
      </button>
    </div>
  </div>
</div>
