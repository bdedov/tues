<div class="card-group-block">
  <div class="col-md-8 col-xs-12 bg-primary edition-promo" style="padding-top: 40px;">
    <div class="row">
      <div class="col-sm-2 col-xs-12">
        <div class="edition-icon">
          <i ng-class="vm.currentPlan.icon"></i>
        </div>
      </div>

      <div class="col-sm-8 col-xs-12" style="min-height: 164px;">
        <p class="lead" style="padding-top: 30px;">
          <span translate ng-if="!vm.currentPlan.trial && vm.currentPlan">Current plan</span>
        </p>
        <h1 class="edition-name">
          {{ vm.currentPlan.label | translate }}
        </h1>
        <p class="lead" ng-if="vm.currentPlan.trial">
          <span translate>
            You are currently using a trial version. Upgrade to unleash the full potential of
            Cumulocity's IoT Platform.
          </span>

          <br />

          <small>
            <a
              href="http://cumulocity.com/pricing"
              style="color:white;"
              target="_blank"
              rel="noopener noreferrer"
              translate
            >
              Find out more
            </a>
          </small>
        </p>
      </div>

      <div class="col-xs-12" style="padding:0;">
        <svg
          class="img-responsive"
          viewBox="0 0 800 73"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
        >
          <g
            id="clouds"
            transform="translate(0.000000, -8.000000)"
            fill-rule="nonzero"
            fill="#FFFFFF"
          >
            <path
              d="M150,29.5010406 C150,29.5010406 241.723942,-4.83292734 337.05605,15.363583 C502.3092,50.3710004 579.247784,13.4189478 650.500513,10.6524254 C754.500342,6.61172864 800,26.8092352 800,26.8092352 L800,81 L150,81 L150,29.5010406 Z"
              id="Shape"
              opacity="0.6"
            ></path>
            <path
              d="M0,23.0191205 C0,23.0191205 54.9127085,10.0740109 85.8483671,8.8815833 C138.217109,6.86300867 160.06201,35.8114919 209.096484,29.0659678 C225.550207,26.8024789 261.108016,16.8919326 280.464078,17.2980031 C329.186903,18.3201582 349.76158,42.8900856 400,40.5 C450.23842,38.1099144 480.881822,11.8815833 550.528908,11.8815833 C620.175993,11.8815833 641.450101,36.6673122 693.671858,40.5 C772.846687,46.3108425 749.423524,15.8736904 800,40.7671534 L800,77.5183701 L0,74.5183701 L0,23.0191205 Z"
              id="Shape"
              opacity="0.6"
            ></path>
            <path
              d="M152.16802,78.2830378 C152.16802,78.2830378 255.401264,9 385.503844,9 C526.373829,9 595,77.2648052 595,77.2648052 L595,81 L150,81 L152.16802,78.2830378 Z"
              id="Shape"
              opacity="0.7"
            ></path>
            <path
              d="M0,40.3029137 C7.94920217e-13,40.3029137 58.5546218,24.8045817 129.298917,24.8045817 C200.043213,24.8045817 227.524978,44.9014568 263.130219,44.9014568 C298.735459,44.9014568 354.013237,23.6582044 388.528971,24.8045817 C423.044704,25.950959 474.684141,49.6927067 531.261582,49.6927067 C587.839022,49.6927067 645.956957,24.4399269 677.430058,24.8045817 C766.681365,25.8386683 800,53.3213433 800,53.3213433 L800,80.8029137 L1.05119385e-12,80.8029137 L0,40.3029137 Z"
              id="Shape"
            ></path>
          </g>
        </svg>
        <div
          class="clearfix"
          style="background-color: white; color:#333; margin-top: -10px; padding-bottom: 15px; min-height: 123px; "
        >
          <div
            class="col-sm-6"
            ng-if="vm.plansAvailableForUpgrade.length < 2 && vm.currentPlan.features.length"
          >
            <ul class="check-bullets success">
              <li ng-repeat="feature in vm.currentPlan.features">
                <span ng-bind-html="feature"></span>
              </li>
            </ul>
          </div>

          <div class="col-sm-6" ng-repeat="plan in vm.plansAvailableForUpgrade">
            <div class="flex-row">
              <div style="font-size: 62px; margin-right:10px;">
                <span ng-class="plan.icon" class="c8y-icon-duocolor"></span>
              </div>
              <div>
                <h4 class="text-uppercase" style="margin-bottom:10px; letter-spacing: 0.15em;">
                  {{ plan.label | translate }}
                </h4>
                <button title="{{ plan.upgradeButtonLabel | translate }}" class="btn btn-success" ng-click="vm.upgradeToPlan(plan)">
                  {{ plan.upgradeButtonLabel | translate }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-4 col-xs-12 text-center card-total">
    <div ng-if="vm.currentPlan.trial && vm.inactivePhaseStartDate">
      <p translate>
        Trial expires in
      </p>
      <h2
        class="text-muted"
        translate
        translate-n="vm.daysLeftInTrial"
        translate-plural="{{ $count }} days"
      >
        1 day
      </h2>
    </div>

    <div ng-if="vm.normalPhaseStartDate">
      <label class="small" translate>
        End of trial period
      </label>
      <p>
        <i c8y-icon="calendar"></i>
        <span>
          <span ng-bind="vm.normalPhaseStartDate | absoluteDateTimeFormat:'llll'"></span>
        </span>
      </p>
      <br />
      <br />
    </div>

    <div ng-if="vm.currentPlan.trial">
      <br />
      <br />

      <p>
        <a
          href="mailto:sales@cumulocity.com"
          class="btn btn-success"
          style="min-width: 200px;"
          translate
        >
          Contact sales
        </a>
      </p>

      <br />
      <br />
    </div>
    <div ng-if="vm.currentPlan.trial">
      <label class="small" translate>
        End of trial period
      </label>
      <p>
        <i c8y-icon="calendar"></i>
        <span ng-bind="vm.inactivePhaseStartDate | absoluteDateTimeFormat:'ll'"></span>
      </p>
    </div>

    <div ng-if="vm.normalPhaseStartDate">
      <label class="small" translate>
        Current balance
      </label>

      <p class="text-light">
        <span style="font-size:46px;" ng-class="{'text-danger': vm.contractInfo.currentDunning}">
          <span
            style="font-size: 14px; font-weight:bold;"
            ng-bind="vm.contractInfo.Currency"
          ></span>
          {{ vm.contractInfo.Balance | currency: '' }}
        </span>
        <span class="status" ng-if="vm.contractInfo.currentDunning">
          (pending)
        </span>
      </p>
      <small class="text-muted status-text" ng-if="vm.contractInfo.currentDunning" translate>
        If you change your payment settings now,<br />
        this amount would be settled immediately.
      </small>

      <br />

      <div ng-if="!vm.inactivePhaseStartDate">
        <label class="small" translate>
          Next billing
        </label>
        <p>
          <i c8y-icon="calendar"></i>
          <span ng-bind="vm.contractInfo.NextBillingDate | absoluteDateTimeFormat:'llll'"></span>
        </p>
      </div>

      <div ng-if="vm.inactivePhaseStartDate">
        <label class="small" translate>
          Last billing and closing account
        </label>
        <p>
          <i c8y-icon="calendar"></i>
          <span ng-bind="vm.inactivePhaseStartDate | absoluteDateTimeFormat:'llll'"></span>
        </p>
      </div>

      <br />
    </div>

    <small ng-if="vm.canCloseAccount">
      <button
        title="{{ 'Close account' | translate }}"
        class="btn btn-link btn-xs"
        ng-click="vm.closeAccount()"
        translate
      >
        Close account
      </button>
    </small>
  </div>
</div>
