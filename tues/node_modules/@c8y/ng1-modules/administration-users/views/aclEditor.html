<div>
  <!-- INVENTORY_ROLES_DEACTIVATION
  <div class="alert alert-warning">
    <i c8y-icon="exclamation-triangle" class="fa-2x pull-left"></i>
    <span translate>This feature is deprecated. Although it continues fully functional you should use the user roles available in administration app</span>
    <a href="/apps/administration#roles" translate>Go to administration</a>
  </div> -->

  <div ng-show="allowEdit && newPermission">
    <div class="row">
      <div class="form-group col-lg-3">
        <label>{{ 'Managed object' | translate }}</label>
        <input
          type="text"
          class="form-control"
          maxlength="100"
          ng-model="newPermission.deviceSearch"
          ng-model-options="{debounce: 300}"
          placeholder="{{ 'Select managed object from list' | translate }}"
          uib-typeahead="device.id+' - '+device.name for device in getDevices($viewValue)"
          typeahead-on-select="setDevice($item)"
          uib-tooltip="{{ 'Start typing deviceâ€™s ID or name to search for it.' | translate }}"
        />
      </div>
      <c8y-device-permission
        data-scope="newPermission.scopeType"
        data-permission-type="newPermission.type"
        data-access="newPermission.permissionType"
        data-device="newPermission.device"
      >
      </c8y-device-permission>
    </div>
    <div class="pull-right">
      <button
        title="{{ 'Add permission' | translate }}"
        type="button"
        class="btn btn-primary"
        ng-disabled="!isValidPermission(newPermission)"
        ng-click="add(newPermission)"
        translate
      >
        Add
      </button>
    </div>
  </div>

  <table class="table table-condensed table-permissions" ng-show="allowView">
    <thead>
      <tr>
        <th translate>Device</th>
        <th translate>Permissions</th>
        <th>&nbsp;</th>
      </tr>
    </thead>
    <tbody ng-repeat="(deviceId, permissions) in acl">
      <tr ng-repeat="permission in permissions track by $index">
        <td ng-if="$first" style="width: 200px;" rowspan="{{ permissions.length }}">
          {{ deviceId }}
        </td>
        <td>
          {{ translatePermissionString(permission) }}
        </td>
        <td class="text-right">
          <button
            ng-show="allowEdit"
            class="btn btn-danger btn-xs showOnHover"
            title="{{ 'Remove permission' | translate }}"
            ng-click="remove(deviceId, permission)"
          >
            <i c8y-icon="times"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
