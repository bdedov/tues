<div data-ng-controller="userDetailCtrl">
  <form name="forms.userForm" role="form" ng-submit="checkPassword(user)" novalidate>
    <div class="row">
      <div class="col-lg-4">
        <div
          c8y-edit-user
          user="user"
          forms="forms"
          password="password"
          disabled-edit="!canEditUser(currentUser, user)"
          hide-active="!canActivateUser(currentUser, user)"
          hide-language="true"
        ></div>
        <button
          title="{{ 'Save' | translate }}"
          ng-if="canEditUser(currentUser, user)"
          ng-class="{'btn-save': showPassword}"
          class="btn btn-primary"
          type="submit"
          ng-disabled="forms.userForm.$invalid || saving"
          translate
        >
          Save
        </button>
      </div>
      <div class="col-lg-8">
        <div class="panel panel-clean">
          <div class="panel-heading">
            <i c8y-icon="users"></i> <translate>Global roles</translate>
          </div>
          <ul class="list-group">
            <li
              class="list-group-item word-break"
              ng-repeat="group in groups"
              ng-class="{'list-group-item-success': _groups[group.id]}"
            >
              <input
                type="checkbox"
                ng-model="_groups[group.id]"
                ng-disabled="!canEditUserGroups(currentUser)"
              />
              <i
                c8y-icon="check-circle"
                class="text-success pull-right"
                ng-show="_groups[group.id]"
              ></i>
              <span title="{{ group.name | translate }}">{{ group.name }}</span>
            </li>
          </ul>
        </div>

        <div class="panel panel-clean" ng-show="showAcl()">
          <div class="panel-heading">
            <i c8y-icon="key"></i> <translate>User permissions</translate>
          </div>
          <div acl-editor acl="user.devicePermissions"></div>
        </div>

        <div class="panel panel-clean" ng-show="showUserApps">
          <div class="panel-heading">
            <i c8y-icon="key"></i> <translate>Application access</translate>
          </div>
          <div
            application-access-editor
            allowed-applications="user.applications"
            disabled-edit="user.id === currentUser.id"
          ></div>
        </div>
      </div>
    </div>
  </form>
</div>
