<div data-ng-controller="userListCtrl">
  <div class="clearfix">
    <c8y-refresh-btn
      title="{{ 'Reload' | translate }}"
      class="pull-right"
      style="margin-bottom:20px;"
    ></c8y-refresh-btn>
    <c8y-if-allowed title="{{ 'Add user' | translate }}" any-role="['ROLE_USER_MANAGEMENT_ADMIN']">
      <a href="#{{ ROUTE_NEW_USER }}" class="btn btn-link pull-right">
        <i c8y-icon="plus"></i> {{ 'Add user' | translate }}
      </a>
    </c8y-if-allowed>
  </div>

  <table class="table table-hover">
    <tr ng-repeat="user in users|orderBy:'userName'">
      <td style="width:30px" class="text-center">
        <i
          c8y-icon="{{ enabledIcon(user) }}"
          data-ng-class="enabledClass(user)"
          uib-tooltip="{{ enabledTooltip(user) | translate }}"
        ></i>
      </td>

      <td data-ng-click="navigateToDetail(user)" class="interact word-break">
        <span>{{ user.userName }}</span>
        <small class="text-muted" style="margin-right:10px;">
          {{ user.firstName }} {{ user.lastName }}
        </small>
        <small ng-show="user.email" class="text-muted">
          <i c8y-icon="envelope-o"></i>
          {{ user.email }}
        </small>
      </td>

      <td style="max-width: 250px;" class="hidden-xs">
        <span
          class="label label-info label-truncated"
          ng-repeat="ref in user.groups.references"
          style="margin-right: 3px;"
          title="{{ ref.group.name }}"
          >{{ ref.group.name }}</span
        >
      </td>

      <td ng-if="isAdmin" c8y-password-strength user="user" class="hidden-xs hidden-sm"></td>

      <td ng-if="tfaAvailable">
        <span
          class="label label-warning label-truncated"
          title="{{ 'TFA status' | translate }}"
          ng-bind="user.tfaStatus | translate"
          ng-hide="user.tfaActive"
        >
        </span>
      </td>

      <td class="text-right word-nobreak">
        <c8y-if-allowed any-role="['ROLE_USER_MANAGEMENT_ADMIN']">
          <div ng-if="user.id !== loggedUserId && !user._tenantAdmin">
            <button
              title="{{ 'Disable user' | translate }}"
              class="btn btn-primary btn-xs showOnHover"
              ng-show="user.enabled"
              data-ng-click="deactivate(user)"
              translate
            >
              Disable
            </button>
            <button
              title="{{ 'Enable user' | translate }}"
              class="btn btn-primary btn-xs showOnHover"
              ng-hide="user.enabled"
              data-ng-click="activate(user)"
              translate
            >
              Enable
            </button>
            <button
              title="{{ 'Delete user' | translate }}"
              class="btn btn-danger btn-xs showOnHover"
              data-ng-click="onClickDelete(user)"
            >
              <i c8y-icon="times"></i>
            </button>
          </div>
        </c8y-if-allowed>
      </td>
    </tr>
  </table>

  <c8y-load-more></c8y-load-more>
</div>
