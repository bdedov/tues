"use strict";!function(){function e(e,t,n,i,a,r,o,s,u,c){function l(e){return t.users||(t.users=[]),e.forEach(function(n){n._tenantAdmin=i.hasRole(n,"ROLE_TENANT_ADMIN"),i.isTfaActive(n).then(function(e){n.tfaActive=e,n.tfaStatus=u(e?"TFA active":"TFA inactive")}),t.users.push(n)}),t.paging=e.paging,t.users.length}function d(){!function(e){var n=e.then(function(e){return{title:u("Users"),subtitle:_.isUndefined(e)?"":c.getString("{{qty}} users",{qty:e})}});o.changeTitle(n)}(i.list().then(l))}t.loadNext=function(){t.paging.loading=!0,t.paging.next().then(l).finally(function(){t.paging.loading=!1})},t.enabledIcon=function(e){return e.enabled?"check-circle":"minus-circle"},t.enabledClass=function(e){return e.enabled?"text-success":"text-danger"},t.enabledTooltip=function(e){return e.enabled?"Enabled":"Disabled"},t.activate=function(e){i.enable(e).then(function(){e.enabled=!0})},t.deactivate=function(e){i.disable(e).then(function(){e.enabled=!1})},t.groups=i.groups,t.navigateToDetail=function(e){n.path("/users/".concat(e.id))},t.onClickDelete=function(e){a({title:u("Delete user"),body:c.getString('You are about to delete user "{{userName}}". Do you want to proceed?',e),labels:{ok:u("Delete")},status:"danger"}).then(angular.bind(i,i.remove,e)).then(angular.bind(r,r.removeFromList,t.users,e))},t.refresh=function(){t.refreshLoading=!0,t.paging.refresh().then(function(e){return t.users=null,delete t.refreshLoading,e}).then(l)},t.ROUTE_NEW_USER=s.ROUTE_NEW_USER,e.$on("userUpdated",function(){t.users=[],d()}),d(),i.current().then(function(e){t.isAdmin=i.isAdmin(e),t.loggedUserId=e.id}),i.isTfaAvailable().then(function(e){t.tfaAvailable=e})}e.$inject=["$rootScope","$scope","$location","c8yUser","c8yModal","c8yBase","c8yTitle","c8yUserUi","gettext","gettextCatalog"],angular.module("c8y.parts.users").controller("userListCtrl",e)}();