import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { DashboardBridgeService } from './dashboard-bridge.service';
import { WidgetComponent } from './widget.component';
import { DeviceSelectorComponent } from './device-selector.component';
let Ng1ComponentFactoryService = class Ng1ComponentFactoryService {
    constructor(bridge) {
        this.bridge = bridge;
    }
    get() {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const components = (yield this.bridge.ng1Components.list()).map(cmp => {
                const data = {
                    settings: Object.assign({}, cmp.options, { configTemplateUrl: cmp.configTemplateUrl, widgetComponent: cmp.widgetComponent, configComponent: cmp.configComponent, transformConfigWithContext: cmp.transformConfigWithContext || cmp.componentTransformConfigWithContext, upgrade: true })
                };
                data.settings.templateUrl = cmp.templateUrl; // workaround as in object it creates build error
                return {
                    id: cmp.name,
                    label: cmp.nameDisplay || cmp.name,
                    description: cmp.description,
                    component: WidgetComponent,
                    configComponent: WidgetComponent,
                    previewImage: cmp.previewImage,
                    data
                };
            });
            // add the device selector legacy component
            components.push({
                id: 'device.selector.legacy',
                label: 'Device selector',
                description: '',
                data: { settings: { noNewWidgets: true, upgrade: true } },
                component: DeviceSelectorComponent
            });
            return components;
        });
    }
};
Ng1ComponentFactoryService.ctorParameters = () => [
    { type: DashboardBridgeService }
];
Ng1ComponentFactoryService = tslib_1.__decorate([
    Injectable()
], Ng1ComponentFactoryService);
export { Ng1ComponentFactoryService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmZhY3RvcnkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYzh5L25neC1jb21wb25lbnRzL3VwZ3JhZGUvIiwic291cmNlcyI6WyJkYXNoYm9hcmQvY29tcG9uZW50LmZhY3RvcnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFM0MsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDcEUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBR3RFLElBQWEsMEJBQTBCLEdBQXZDLE1BQWEsMEJBQTBCO0lBQ3JDLFlBQW9CLE1BQThCO1FBQTlCLFdBQU0sR0FBTixNQUFNLENBQXdCO0lBQUcsQ0FBQztJQUNoRCxHQUFHOztZQUNQLE1BQU0sVUFBVSxHQUFHLENBQUMsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDcEUsTUFBTSxJQUFJLEdBQUc7b0JBQ1gsUUFBUSxvQkFDSCxHQUFHLENBQUMsT0FBTyxJQUNkLGlCQUFpQixFQUFFLEdBQUcsQ0FBQyxpQkFBaUIsRUFDeEMsZUFBZSxFQUFFLEdBQUcsQ0FBQyxlQUFlLEVBQ3BDLGVBQWUsRUFBRSxHQUFHLENBQUMsZUFBZSxFQUNwQywwQkFBMEIsRUFDeEIsR0FBRyxDQUFDLDBCQUEwQixJQUFJLEdBQUcsQ0FBQyxtQ0FBbUMsRUFDM0UsT0FBTyxFQUFFLElBQUksR0FDZDtpQkFDSyxDQUFDO2dCQUNULElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxpREFBaUQ7Z0JBRTlGLE9BQU87b0JBQ0wsRUFBRSxFQUFFLEdBQUcsQ0FBQyxJQUFJO29CQUNaLEtBQUssRUFBRSxHQUFHLENBQUMsV0FBVyxJQUFJLEdBQUcsQ0FBQyxJQUFJO29CQUNsQyxXQUFXLEVBQUUsR0FBRyxDQUFDLFdBQVc7b0JBQzVCLFNBQVMsRUFBRSxlQUFlO29CQUMxQixlQUFlLEVBQUUsZUFBZTtvQkFDaEMsWUFBWSxFQUFFLEdBQUcsQ0FBQyxZQUFZO29CQUM5QixJQUFJO2lCQUN5QixDQUFDO1lBQ2xDLENBQUMsQ0FBQyxDQUFDO1lBRUgsMkNBQTJDO1lBQzNDLFVBQVUsQ0FBQyxJQUFJLENBQUM7Z0JBQ2QsRUFBRSxFQUFFLHdCQUF3QjtnQkFDNUIsS0FBSyxFQUFFLGlCQUFpQjtnQkFDeEIsV0FBVyxFQUFFLEVBQUU7Z0JBQ2YsSUFBSSxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLEVBQUU7Z0JBQ3pELFNBQVMsRUFBRSx1QkFBdUI7YUFDbkMsQ0FBQyxDQUFDO1lBRUgsT0FBTyxVQUFVLENBQUM7UUFDcEIsQ0FBQztLQUFBO0NBQ0YsQ0FBQTs7WUF0QzZCLHNCQUFzQjs7QUFEdkMsMEJBQTBCO0lBRHRDLFVBQVUsRUFBRTtHQUNBLDBCQUEwQixDQXVDdEM7U0F2Q1ksMEJBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRHluYW1pY0NvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICdAYzh5L25neC1jb21wb25lbnRzJztcbmltcG9ydCB7IERhc2hib2FyZEJyaWRnZVNlcnZpY2UgfSBmcm9tICcuL2Rhc2hib2FyZC1icmlkZ2Uuc2VydmljZSc7XG5pbXBvcnQgeyBXaWRnZXRDb21wb25lbnQgfSBmcm9tICcuL3dpZGdldC5jb21wb25lbnQnO1xuaW1wb3J0IHsgRGV2aWNlU2VsZWN0b3JDb21wb25lbnQgfSBmcm9tICcuL2RldmljZS1zZWxlY3Rvci5jb21wb25lbnQnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTmcxQ29tcG9uZW50RmFjdG9yeVNlcnZpY2Uge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGJyaWRnZTogRGFzaGJvYXJkQnJpZGdlU2VydmljZSkge31cbiAgYXN5bmMgZ2V0KCkge1xuICAgIGNvbnN0IGNvbXBvbmVudHMgPSAoYXdhaXQgdGhpcy5icmlkZ2UubmcxQ29tcG9uZW50cy5saXN0KCkpLm1hcChjbXAgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAuLi5jbXAub3B0aW9ucyxcbiAgICAgICAgICBjb25maWdUZW1wbGF0ZVVybDogY21wLmNvbmZpZ1RlbXBsYXRlVXJsLFxuICAgICAgICAgIHdpZGdldENvbXBvbmVudDogY21wLndpZGdldENvbXBvbmVudCxcbiAgICAgICAgICBjb25maWdDb21wb25lbnQ6IGNtcC5jb25maWdDb21wb25lbnQsXG4gICAgICAgICAgdHJhbnNmb3JtQ29uZmlnV2l0aENvbnRleHQ6XG4gICAgICAgICAgICBjbXAudHJhbnNmb3JtQ29uZmlnV2l0aENvbnRleHQgfHwgY21wLmNvbXBvbmVudFRyYW5zZm9ybUNvbmZpZ1dpdGhDb250ZXh0LFxuICAgICAgICAgIHVwZ3JhZGU6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSBhcyBhbnk7XG4gICAgICBkYXRhLnNldHRpbmdzLnRlbXBsYXRlVXJsID0gY21wLnRlbXBsYXRlVXJsOyAvLyB3b3JrYXJvdW5kIGFzIGluIG9iamVjdCBpdCBjcmVhdGVzIGJ1aWxkIGVycm9yXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBjbXAubmFtZSxcbiAgICAgICAgbGFiZWw6IGNtcC5uYW1lRGlzcGxheSB8fCBjbXAubmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNtcC5kZXNjcmlwdGlvbixcbiAgICAgICAgY29tcG9uZW50OiBXaWRnZXRDb21wb25lbnQsXG4gICAgICAgIGNvbmZpZ0NvbXBvbmVudDogV2lkZ2V0Q29tcG9uZW50LFxuICAgICAgICBwcmV2aWV3SW1hZ2U6IGNtcC5wcmV2aWV3SW1hZ2UsXG4gICAgICAgIGRhdGFcbiAgICAgIH0gYXMgRHluYW1pY0NvbXBvbmVudERlZmluaXRpb247XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIGRldmljZSBzZWxlY3RvciBsZWdhY3kgY29tcG9uZW50XG4gICAgY29tcG9uZW50cy5wdXNoKHtcbiAgICAgIGlkOiAnZGV2aWNlLnNlbGVjdG9yLmxlZ2FjeScsXG4gICAgICBsYWJlbDogJ0RldmljZSBzZWxlY3RvcicsXG4gICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICBkYXRhOiB7IHNldHRpbmdzOiB7IG5vTmV3V2lkZ2V0czogdHJ1ZSwgdXBncmFkZTogdHJ1ZSB9IH0sXG4gICAgICBjb21wb25lbnQ6IERldmljZVNlbGVjdG9yQ29tcG9uZW50XG4gICAgfSk7XG5cbiAgICByZXR1cm4gY29tcG9uZW50cztcbiAgfVxufVxuIl19