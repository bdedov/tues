import * as tslib_1 from "tslib";
import { Component, ViewChild } from '@angular/core';
import { C8yStepper, gettext, ModalService, Status } from '@c8y/ngx-components';
import { TranslateService } from '@ngx-translate/core';
import { uniq } from 'lodash-es';
import { BaseStepperComponent } from '../base-stepper.component';
import { SelectSoftwareStepComponent } from './software-update-stepper/select-software-step.component';
let StepperBulkTypeSoftware = class StepperBulkTypeSoftware extends BaseStepperComponent {
    constructor(modal, translate) {
        super();
        this.modal = modal;
        this.translate = translate;
        this.descriptionTemplateSingle = gettext('Update software to: {{ name }} (version {{ version }})');
        this.descriptionTemplateOneOther = gettext('Update software to: {{ name }} (version {{ version }}) and one other');
        this.descriptionTemplateMultiple = gettext('Update software to: {{ name }} (version {{ version }}) and {{ count }} others');
        this.selectedSoftware = [];
    }
    onSoftwareSelected(selectedItem) {
        this.selectedSoftware = this.selectedSoftware.filter(item => item.software.id !== selectedItem.software.id);
        this.selectedSoftware.push(selectedItem);
    }
    confirmSoftwareSelection($event) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const deviceTypes = this.getUniqueDeviceTypes();
            this.deviceTypes = deviceTypes;
            if (deviceTypes.length > 1) {
                try {
                    yield this.modal.confirm(gettext('Selected software for various device types'), gettext('Operation may fail due to unsupported software. Do you want to proceed?'), Status.WARNING, { ok: gettext('Confirm'), cancel: gettext('Cancel') });
                    $event.stepper.next();
                }
                catch (ex) {
                    this.selectedSoftware = [];
                    this.selectSoftware.resetSelection();
                }
            }
            else {
                $event.stepper.next();
            }
        });
    }
    retrieveOperationPrototype() {
        const softwareList = this.selectedSoftware.map(item => ({
            name: item.software.name,
            version: item.version.c8y_Software.version,
            url: item.version.c8y_Software.url,
            action: item.action
        }));
        const interpolationParams = {
            name: softwareList[0].name,
            version: softwareList[0].version,
            count: softwareList.length - 1
        };
        let description;
        switch (softwareList.length) {
            case 1:
                description = this.translate.instant(this.descriptionTemplateSingle, interpolationParams);
                break;
            case 2:
                description = this.translate.instant(this.descriptionTemplateOneOther, interpolationParams);
                break;
            default:
                description = this.translate.instant(this.descriptionTemplateMultiple, interpolationParams);
        }
        return {
            name: gettext('Software update'),
            prototype: {
                description,
                c8y_SoftwareUpdate: softwareList
            }
        };
    }
    getUniqueDeviceTypes() {
        return uniq(this.selectedSoftware
            .map(item => item.software.c8y_Filter && item.software.c8y_Filter.type)
            .filter(type => !!type));
    }
};
StepperBulkTypeSoftware.ctorParameters = () => [
    { type: ModalService },
    { type: TranslateService }
];
tslib_1.__decorate([
    ViewChild(SelectSoftwareStepComponent, { static: false })
], StepperBulkTypeSoftware.prototype, "selectSoftware", void 0);
StepperBulkTypeSoftware = tslib_1.__decorate([
    Component({
        selector: 'c8y-stepper-bulk-type-software',
        template: "<c8y-bulk-operation-stepper>\n  <ng-container\n    *customStep=\"\n      'Select software' | translate; \n      completed: !!selectedSoftware.length;\n      buttonsDisabled: !selectedSoftware.length; \n      onNext: confirmSoftwareSelection.bind(this)\"\n  >\n    <c8y-select-software-step\n      (software)=\"onSoftwareSelected($event)\"\n      class=\"d-contents\"\n    ></c8y-select-software-step>\n  </ng-container>\n  <ng-container *customStep=\"'Confirm selected software' | translate\">\n    <c8y-confirm-software-selection-step\n      class=\"d-contents\"\n      [selectedItems]=\"selectedSoftware\"\n    ></c8y-confirm-software-selection-step>\n  </ng-container>\n</c8y-bulk-operation-stepper>\n"
    })
], StepperBulkTypeSoftware);
export { StepperBulkTypeSoftware };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RlcHBlci1idWxrLXR5cGUtc29mdHdhcmUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy9vcGVyYXRpb25zLyIsInNvdXJjZXMiOlsiYnVsay9jcmVhdGlvbi9zdGVwcGVyLWJ1bGstdHlwZS1zb2Z0d2FyZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXJELE9BQU8sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBRWpFLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBVXZHLElBQWEsdUJBQXVCLEdBQXBDLE1BQWEsdUJBQXdCLFNBQVEsb0JBQW9CO0lBZS9ELFlBQW9CLEtBQW1CLEVBQVUsU0FBMkI7UUFDMUUsS0FBSyxFQUFFLENBQUM7UUFEVSxVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVUsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUFkbkUsOEJBQXlCLEdBQVcsT0FBTyxDQUNsRCx3REFBd0QsQ0FDekQsQ0FBQztRQUNPLGdDQUEyQixHQUFXLE9BQU8sQ0FDcEQsc0VBQXNFLENBQ3ZFLENBQUM7UUFDTyxnQ0FBMkIsR0FBVyxPQUFPLENBQ3BELCtFQUErRSxDQUNoRixDQUFDO1FBRUYscUJBQWdCLEdBQXdCLEVBQUUsQ0FBQztJQU0zQyxDQUFDO0lBRUQsa0JBQWtCLENBQUMsWUFBWTtRQUM3QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixD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QyxRQUFRLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQzthQUN0RSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQzFCLENBQUM7SUFDSixDQUFDO0NBQ0YsQ0FBQTs7WUF6RTRCLFlBQVk7WUFBcUIsZ0JBQWdCOztBQUY1RTtJQURDLFNBQVMsQ0FBQywyQkFBMkIsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQzsrREFDZDtBQWJqQyx1QkFBdUI7SUFKbkMsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLGdDQUFnQztRQUMxQyw0c0JBQXdEO0tBQ3pELENBQUM7R0FDVyx1QkFBdUIsQ0F3Rm5DO1NBeEZZLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENka1N0ZXAgfSBmcm9tICdAYW5ndWxhci9jZGsvc3RlcHBlcic7XG5pbXBvcnQgeyBDb21wb25lbnQsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSU9wZXJhdGlvbiB9IGZyb20gJ0BjOHkvY2xpZW50JztcbmltcG9ydCB7IEM4eVN0ZXBwZXIsIGdldHRleHQsIE1vZGFsU2VydmljZSwgU3RhdHVzIH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cyc7XG5pbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5pbXBvcnQgeyB1bmlxIH0gZnJvbSAnbG9kYXNoLWVzJztcbmltcG9ydCB7IEJhc2VTdGVwcGVyQ29tcG9uZW50IH0gZnJvbSAnLi4vYmFzZS1zdGVwcGVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBPcGVyYXRpb25EZXRhaWxzIH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cy9vcGVyYXRpb25zL2J1bGstb3BlcmF0aW9ucy1zZXJ2aWNlJztcbmltcG9ydCB7IFNlbGVjdFNvZnR3YXJlU3RlcENvbXBvbmVudCB9IGZyb20gJy4vc29mdHdhcmUtdXBkYXRlLXN0ZXBwZXIvc2VsZWN0LXNvZnR3YXJlLXN0ZXAuY29tcG9uZW50JztcbmltcG9ydCB7XG4gIElTZWxlY3RlZFNvZnR3YXJlLFxuICBJU29mdHdhcmVVcGRhdGVPcGVyYXRpb25Qcm90b3R5cGVcbn0gZnJvbSAnLi9zb2Z0d2FyZS11cGRhdGUtc3RlcHBlci9zZWxlY3Qtc29mdHdhcmUubW9kZWwnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktc3RlcHBlci1idWxrLXR5cGUtc29mdHdhcmUnLFxuICB0ZW1wbGF0ZVVybDogJ3N0ZXBwZXItYnVsay10eXBlLXNvZnR3YXJlLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBTdGVwcGVyQnVsa1R5cGVTb2Z0d2FyZSBleHRlbmRzIEJhc2VTdGVwcGVyQ29tcG9uZW50IHtcbiAgcmVhZG9ubHkgZGVzY3JpcHRpb25UZW1wbGF0ZVNpbmdsZTogc3RyaW5nID0gZ2V0dGV4dChcbiAgICAnVXBkYXRlIHNvZnR3YXJlIHRvOiB7eyBuYW1lIH19ICh2ZXJzaW9uIHt7IHZlcnNpb24gfX0pJ1xuICApO1xuICByZWFkb25seSBkZXNjcmlwdGlvblRlbXBsYXRlT25lT3RoZXI6IHN0cmluZyA9IGdldHRleHQoXG4gICAgJ1VwZGF0ZSBzb2Z0d2FyZSB0bzoge3sgbmFtZSB9fSAodmVyc2lvbiB7eyB2ZXJzaW9uIH19KSBhbmQgb25lIG90aGVyJ1xuICApO1xuICByZWFkb25seSBkZXNjcmlwdGlvblRlbXBsYXRlTXVsdGlwbGU6IHN0cmluZyA9IGdldHRleHQoXG4gICAgJ1VwZGF0ZSBzb2Z0d2FyZSB0bzoge3sgbmFtZSB9fSAodmVyc2lvbiB7eyB2ZXJzaW9uIH19KSBhbmQge3sgY291bnQgfX0gb3RoZXJzJ1xuICApO1xuXG4gIHNlbGVjdGVkU29mdHdhcmU6IElTZWxlY3RlZFNvZnR3YXJlW10gPSBbXTtcbiAgQFZpZXdDaGlsZChTZWxlY3RTb2Z0d2FyZVN0ZXBDb21wb25lbnQsIHsgc3RhdGljOiBmYWxzZSB9KVxuICBzZWxlY3RTb2Z0d2FyZTogU2VsZWN0U29mdHdhcmVTdGVwQ29tcG9uZW50O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbW9kYWw6IE1vZGFsU2VydmljZSwgcHJpdmF0ZSB0cmFuc2xhdGU6IFRyYW5zbGF0ZVNlcnZpY2UpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgb25Tb2Z0d2FyZVNlbGVjdGVkKHNlbGVjdGVkSXRlbSkge1xuICAgIHRoaXMuc2VsZWN0ZWRTb2Z0d2FyZSA9IHRoaXMuc2VsZWN0ZWRTb2Z0d2FyZS5maWx0ZXIoXG4gICAgICBpdGVtID0+IGl0ZW0uc29mdHdhcmUuaWQgIT09IHNlbGVjdGVkSXRlbS5zb2Z0d2FyZS5pZFxuICAgICk7XG4gICAgdGhpcy5zZWxlY3RlZFNvZnR3YXJlLnB1c2goc2VsZWN0ZWRJdGVtKTtcbiAgfVxuXG4gIGFzeW5jIGNvbmZpcm1Tb2Z0d2FyZVNlbGVjdGlvbigkZXZlbnQ6IHsgc3RlcHBlcjogQzh5U3RlcHBlcjsgc3RlcDogQ2RrU3RlcCB9KSB7XG4gICAgY29uc3QgZGV2aWNlVHlwZXM6IHN0cmluZ1tdID0gdGhpcy5nZXRVbmlxdWVEZXZpY2VUeXBlcygpO1xuICAgIHRoaXMuZGV2aWNlVHlwZXMgPSBkZXZpY2VUeXBlcztcbiAgICBpZiAoZGV2aWNlVHlwZXMubGVuZ3RoID4gMSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5tb2RhbC5jb25maXJtKFxuICAgICAgICAgIGdldHRleHQoJ1NlbGVjdGVkIHNvZnR3YXJlIGZvciB2YXJpb3VzIGRldmljZSB0eXBlcycpLFxuICAgICAgICAgIGdldHRleHQoJ09wZXJhdGlvbiBtYXkgZmFpbCBkdWUgdG8gdW5zdXBwb3J0ZWQgc29mdHdhcmUuIERvIHlvdSB3YW50IHRvIHByb2NlZWQ/JyksXG4gICAgICAgICAgU3RhdHVzLldBUk5JTkcsXG4gICAgICAgICAgeyBvazogZ2V0dGV4dCgnQ29uZmlybScpLCBjYW5jZWw6IGdldHRleHQoJ0NhbmNlbCcpIH1cbiAgICAgICAgKTtcbiAgICAgICAgJGV2ZW50LnN0ZXBwZXIubmV4dCgpO1xuICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFNvZnR3YXJlID0gW107XG4gICAgICAgIHRoaXMuc2VsZWN0U29mdHdhcmUucmVzZXRTZWxlY3Rpb24oKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJGV2ZW50LnN0ZXBwZXIubmV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCByZXRyaWV2ZU9wZXJhdGlvblByb3RvdHlwZSgpOiBPcGVyYXRpb25EZXRhaWxzIHtcbiAgICBjb25zdCBzb2Z0d2FyZUxpc3Q6IElTb2Z0d2FyZVVwZGF0ZU9wZXJhdGlvblByb3RvdHlwZVtdID0gdGhpcy5zZWxlY3RlZFNvZnR3YXJlLm1hcChpdGVtID0+ICh7XG4gICAgICBuYW1lOiBpdGVtLnNvZnR3YXJlLm5hbWUsXG4gICAgICB2ZXJzaW9uOiBpdGVtLnZlcnNpb24uYzh5X1NvZnR3YXJlLnZlcnNpb24sXG4gICAgICB1cmw6IGl0ZW0udmVyc2lvbi5jOHlfU29mdHdhcmUudXJsLFxuICAgICAgYWN0aW9uOiBpdGVtLmFjdGlvblxuICAgIH0pKTtcblxuICAgIGNvbnN0IGludGVycG9sYXRpb25QYXJhbXM6IG9iamVjdCA9IHtcbiAgICAgIG5hbWU6IHNvZnR3YXJlTGlzdFswXS5uYW1lLFxuICAgICAgdmVyc2lvbjogc29mdHdhcmVMaXN0WzBdLnZlcnNpb24sXG4gICAgICBjb3VudDogc29mdHdhcmVMaXN0Lmxlbmd0aCAtIDFcbiAgICB9O1xuICAgIGxldCBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHN3aXRjaCAoc29mdHdhcmVMaXN0Lmxlbmd0aCkge1xuICAgICAgY2FzZSAxOlxuICAgICAgICBkZXNjcmlwdGlvbiA9IHRoaXMudHJhbnNsYXRlLmluc3RhbnQodGhpcy5kZXNjcmlwdGlvblRlbXBsYXRlU2luZ2xlLCBpbnRlcnBvbGF0aW9uUGFyYW1zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGRlc2NyaXB0aW9uID0gdGhpcy50cmFuc2xhdGUuaW5zdGFudCh0aGlzLmRlc2NyaXB0aW9uVGVtcGxhdGVPbmVPdGhlciwgaW50ZXJwb2xhdGlvblBhcmFtcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgZGVzY3JpcHRpb24gPSB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KHRoaXMuZGVzY3JpcHRpb25UZW1wbGF0ZU11bHRpcGxlLCBpbnRlcnBvbGF0aW9uUGFyYW1zKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogZ2V0dGV4dCgnU29mdHdhcmUgdXBkYXRlJyksXG4gICAgICBwcm90b3R5cGU6ICh7XG4gICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICBjOHlfU29mdHdhcmVVcGRhdGU6IHNvZnR3YXJlTGlzdFxuICAgICAgfSBhcyB1bmtub3duKSBhcyBJT3BlcmF0aW9uXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VW5pcXVlRGV2aWNlVHlwZXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB1bmlxKFxuICAgICAgdGhpcy5zZWxlY3RlZFNvZnR3YXJlXG4gICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnNvZnR3YXJlLmM4eV9GaWx0ZXIgJiYgaXRlbS5zb2Z0d2FyZS5jOHlfRmlsdGVyLnR5cGUpXG4gICAgICAgIC5maWx0ZXIodHlwZSA9PiAhIXR5cGUpXG4gICAgKTtcbiAgfVxufVxuIl19