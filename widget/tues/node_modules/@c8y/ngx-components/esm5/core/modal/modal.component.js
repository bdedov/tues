import * as tslib_1 from "tslib";
import { Component, Input, Optional, Output, EventEmitter, HostListener } from '@angular/core';
import { BsModalRef } from 'ngx-bootstrap/modal';
import { gettext } from '../i18n/gettext';
import { isEmpty } from 'lodash';
/**
 * C8y modal component.
 * ## Example:
 *
 * Creating custom modal:
 * ```typescript
 *  import { Component } from "@angular/core";
 *  import { Subject } from 'rxjs';
 *
 * @Component({
 *  selector: "my-modal",
 *  template: `
 *    <c8y-modal title="CustomTitle"
 *      (onClose)="onClose($event)"
 *      (onDismiss)="onDismiss($event)"
 *      [labels]="labels"
 *      [disabled]="true" <- will disable ok button
 *      >
 *        <span>I am body of modal</span>
 *        <span>For simple string use body="string"</span>
 *    </c8y-modal>`
 * })
 *
 * export class MyModalComponent {
 *
 *  closeSubject: Subject<boolean> = new Subject();
 *  labels : ModalLabels = {ok: "customOK", cancel: "customCancel"};
 *
 *  onDismiss(event){
 *    this.closeSubject.next(false);
 *  }
 *
 *  onClose(event) {
 *    this.closeSubject.next(true);
 *  }
 * }
 * ```
 * Showing modal:
 * ```typescript
 * import { BsModalService } from "ngx-bootstrap/modal";
 *
 * constructor(
 *  public bsModalService: BsModalService,
 * ) {}
 *
 * showModal() {
 *  const modalRef = this.bsModalService.show(MyModalComponent);
 *  modalRef.content.closeSubject.subscribe(result => {
 *    console.log('results:', result);
 *  });
 * }
 * ```
 */
var ModalComponent = /** @class */ (function () {
    function ModalComponent(modal) {
        this.modal = modal;
        this.onDismiss = new EventEmitter();
        this.onClose = new EventEmitter();
        this.disabled = false;
        this.customFooter = false;
        this._labels = { ok: gettext('OK'), cancel: gettext('Cancel') };
    }
    Object.defineProperty(ModalComponent.prototype, "labels", {
        get: function () { return this._labels; },
        set: function (_a) {
            var ok = _a.ok, cancel = _a.cancel;
            this._labels = { ok: ok, cancel: cancel };
        },
        enumerable: true,
        configurable: true
    });
    ModalComponent.prototype._dismiss = function () {
        var _this = this;
        var fn = this.dismiss;
        if (!fn && this.modal) {
            fn = function () { return _this.modal.hide(); };
        }
        if (fn) {
            fn();
        }
        this.onDismiss.emit(true);
    };
    ModalComponent.prototype._close = function () {
        var _this = this;
        var fn = this.close;
        if (!fn && this.modal) {
            fn = function () { return _this.modal.hide(); };
        }
        if (fn) {
            fn();
        }
        this.onClose.emit(true);
    };
    ModalComponent.prototype.onEnterKeyDown = function (event) {
        var hasOnlyOneButton = isEmpty(this.labels.ok) !== isEmpty(this.labels.cancel);
        var isCancelClickable = !this.customFooter && this.labels.cancel;
        var isOkClickable = !this.customFooter && !this.disabled && this.labels.ok;
        if (hasOnlyOneButton && isCancelClickable) {
            this._dismiss();
        }
        if (hasOnlyOneButton && isOkClickable) {
            this._close();
        }
    };
    ModalComponent.ctorParameters = function () { return [
        { type: BsModalRef, decorators: [{ type: Optional }] }
    ]; };
    tslib_1.__decorate([
        Output()
    ], ModalComponent.prototype, "onDismiss", void 0);
    tslib_1.__decorate([
        Output()
    ], ModalComponent.prototype, "onClose", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "disabled", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "close", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "dismiss", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "title", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "body", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "customFooter", void 0);
    tslib_1.__decorate([
        Input()
    ], ModalComponent.prototype, "labels", null);
    tslib_1.__decorate([
        HostListener('document:keydown.enter', ['$event'])
    ], ModalComponent.prototype, "onEnterKeyDown", null);
    ModalComponent = tslib_1.__decorate([
        Component({
            selector: 'c8y-modal',
            template: "<div class=\"modal-header\">\n  <ng-content select=\"[c8y-modal-title]\"></ng-content>\n  <h3 [hidden]=\"!title\">{{title | translate}}</h3>\n</div>\n<div class=\"modal-body\">\n  <p\n    [hidden]=\"!title\"\n    class=\"text-center text-wrap\"\n    style=\"word-wrap:break-word;\"\n  >{{body}}</p>\n  <ng-content></ng-content>\n</div>\n<div class=\"modal-footer\" *ngIf=\"!customFooter\">\n  <ng-content select=\"[c8y-modal-footer]\"></ng-content>\n  <button\n    title=\"{{ labels.cancel | translate }}\" \n    *ngIf=\"labels.cancel\"\n    class=\"btn btn-default\"\n    (click)=\"_dismiss()\"\n  >{{labels.cancel | translate}}</button>\n  <button\n    title=\"{{ labels.ok | translate }}\" \n    *ngIf=\"labels.ok\"\n    class=\"btn btn-primary\"\n    (click)=\"_close()\"\n    [disabled]=\"disabled\"\n  >{{labels.ok | translate}}</button>\n</div>\n"
        }),
        tslib_1.__param(0, Optional())
    ], ModalComponent);
    return ModalComponent;
}());
export { ModalComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbImNvcmUvbW9kYWwvbW9kYWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0YsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMxQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBR2pDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBb0RHO0FBTUg7SUFpQkUsd0JBQWdDLEtBQWlCO1FBQWpCLFVBQUssR0FBTCxLQUFLLENBQVk7UUFoQnZDLGNBQVMsR0FBMEIsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUN0RCxZQUFPLEdBQTBCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDckQsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUtqQixpQkFBWSxHQUFZLEtBQUssQ0FBQztRQU8vQixZQUFPLEdBQWlCLEVBQUUsRUFBRSxFQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7SUFFN0IsQ0FBQztJQVI1QyxzQkFBSSxrQ0FBTTthQUluQixjQUE0QixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2FBSnpDLFVBQVcsRUFBeUI7Z0JBQXhCLFVBQUUsRUFBRSxrQkFBTTtZQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUMsRUFBRSxJQUFBLEVBQUcsTUFBTSxRQUFBLEVBQUMsQ0FBQztRQUMvQixDQUFDOzs7T0FBQTtJQVFELGlDQUFRLEdBQVI7UUFBQSxpQkFLQztRQUpDLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDdEIsSUFBSSxDQUFDLEVBQUUsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQUUsRUFBRSxHQUFHLGNBQU0sT0FBQSxLQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFqQixDQUFpQixDQUFDO1NBQUU7UUFDeEQsSUFBSSxFQUFFLEVBQUU7WUFBRSxFQUFFLEVBQUUsQ0FBQztTQUFFO1FBQ2pCLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRCwrQkFBTSxHQUFOO1FBQUEsaUJBS0M7UUFKQyxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3BCLElBQUksQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtZQUFFLEVBQUUsR0FBRyxjQUFNLE9BQUEsS0FBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsRUFBakIsQ0FBaUIsQ0FBQztTQUFFO1FBQ3hELElBQUksRUFBRSxFQUFFO1lBQUUsRUFBRSxFQUFFLENBQUM7U0FBRTtRQUNqQixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRW1ELHVDQUFjLEdBQWQsVUFBZSxLQUFvQjtRQUNyRixJQUFNLGdCQUFnQixHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2pGLElBQU0saUJBQWlCLEdBQUcsQ0FBQyxJQUFJLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO1FBQ25FLElBQU0sYUFBYSxHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7UUFDN0UsSUFBSSxnQkFBZ0IsSUFBSyxpQkFBaUIsRUFBRTtZQUMxQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDakI7UUFDRCxJQUFJLGdCQUFnQixJQUFLLGFBQWEsRUFBRTtZQUN0QyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7U0FDZjtJQUNILENBQUM7O2dCQTFCc0MsVUFBVSx1QkFBcEMsUUFBUTs7SUFoQlg7UUFBVCxNQUFNLEVBQUU7cURBQXVEO0lBQ3REO1FBQVQsTUFBTSxFQUFFO21EQUFxRDtJQUNyRDtRQUFSLEtBQUssRUFBRTtvREFBa0I7SUFDakI7UUFBUixLQUFLLEVBQUU7aURBQW1CO0lBQ2xCO1FBQVIsS0FBSyxFQUFFO21EQUFxQjtJQUNwQjtRQUFSLEtBQUssRUFBRTtpREFBZTtJQUNkO1FBQVIsS0FBSyxFQUFFO2dEQUFjO0lBQ2I7UUFBUixLQUFLLEVBQUU7d0RBQStCO0lBQzlCO1FBQVIsS0FBSyxFQUFFO2dEQUVQO0lBc0JtRDtRQUFuRCxZQUFZLENBQUMsd0JBQXdCLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQzt3REFVbEQ7SUEzQ1UsY0FBYztRQUwxQixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsV0FBVztZQUNyQixpMkJBQXFDO1NBQ3RDLENBQUM7UUFtQmEsbUJBQUEsUUFBUSxFQUFFLENBQUE7T0FqQlosY0FBYyxDQTRDMUI7SUFBRCxxQkFBQztDQUFBLEFBNUNELElBNENDO1NBNUNZLGNBQWMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPcHRpb25hbCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIEhvc3RMaXN0ZW5lciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQnNNb2RhbFJlZiB9IGZyb20gJ25neC1ib290c3RyYXAvbW9kYWwnO1xuaW1wb3J0IHsgZ2V0dGV4dCB9IGZyb20gJy4uL2kxOG4vZ2V0dGV4dCc7XG5pbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IE1vZGFsTGFiZWxzIH0gZnJvbSAnLi4vc2VsZWN0LW1vZGFsL3NlbGVjdC1tb2RhbC5tb2RlbCc7XG5cbi8qKlxuICogQzh5IG1vZGFsIGNvbXBvbmVudC5cbiAqICMjIEV4YW1wbGU6XG4gKlxuICogQ3JlYXRpbmcgY3VzdG9tIG1vZGFsOlxuICogYGBgdHlwZXNjcmlwdFxuICogIGltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG4gKiAgaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuICpcbiAqIEBDb21wb25lbnQoe1xuICogIHNlbGVjdG9yOiBcIm15LW1vZGFsXCIsXG4gKiAgdGVtcGxhdGU6IGBcbiAqICAgIDxjOHktbW9kYWwgdGl0bGU9XCJDdXN0b21UaXRsZVwiXG4gKiAgICAgIChvbkNsb3NlKT1cIm9uQ2xvc2UoJGV2ZW50KVwiXG4gKiAgICAgIChvbkRpc21pc3MpPVwib25EaXNtaXNzKCRldmVudClcIlxuICogICAgICBbbGFiZWxzXT1cImxhYmVsc1wiXG4gKiAgICAgIFtkaXNhYmxlZF09XCJ0cnVlXCIgPC0gd2lsbCBkaXNhYmxlIG9rIGJ1dHRvblxuICogICAgICA+XG4gKiAgICAgICAgPHNwYW4+SSBhbSBib2R5IG9mIG1vZGFsPC9zcGFuPlxuICogICAgICAgIDxzcGFuPkZvciBzaW1wbGUgc3RyaW5nIHVzZSBib2R5PVwic3RyaW5nXCI8L3NwYW4+XG4gKiAgICA8L2M4eS1tb2RhbD5gXG4gKiB9KVxuICpcbiAqIGV4cG9ydCBjbGFzcyBNeU1vZGFsQ29tcG9uZW50IHtcbiAqXG4gKiAgY2xvc2VTdWJqZWN0OiBTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IFN1YmplY3QoKTtcbiAqICBsYWJlbHMgOiBNb2RhbExhYmVscyA9IHtvazogXCJjdXN0b21PS1wiLCBjYW5jZWw6IFwiY3VzdG9tQ2FuY2VsXCJ9O1xuICpcbiAqICBvbkRpc21pc3MoZXZlbnQpe1xuICogICAgdGhpcy5jbG9zZVN1YmplY3QubmV4dChmYWxzZSk7XG4gKiAgfVxuICpcbiAqICBvbkNsb3NlKGV2ZW50KSB7XG4gKiAgICB0aGlzLmNsb3NlU3ViamVjdC5uZXh0KHRydWUpO1xuICogIH1cbiAqIH1cbiAqIGBgYFxuICogU2hvd2luZyBtb2RhbDpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSBcIm5neC1ib290c3RyYXAvbW9kYWxcIjtcbiAqXG4gKiBjb25zdHJ1Y3RvcihcbiAqICBwdWJsaWMgYnNNb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxuICogKSB7fVxuICpcbiAqIHNob3dNb2RhbCgpIHtcbiAqICBjb25zdCBtb2RhbFJlZiA9IHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2hvdyhNeU1vZGFsQ29tcG9uZW50KTtcbiAqICBtb2RhbFJlZi5jb250ZW50LmNsb3NlU3ViamVjdC5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAqICAgIGNvbnNvbGUubG9nKCdyZXN1bHRzOicsIHJlc3VsdCk7XG4gKiAgfSk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LW1vZGFsJyxcbiAgdGVtcGxhdGVVcmw6ICcuL21vZGFsLmNvbXBvbmVudC5odG1sJyxcbn0pXG5cbmV4cG9ydCBjbGFzcyBNb2RhbENvbXBvbmVudCB7XG4gIEBPdXRwdXQoKSBvbkRpc21pc3M6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIG9uQ2xvc2U6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcbiAgQElucHV0KCkgY2xvc2U6ICgpID0+IHZvaWQ7XG4gIEBJbnB1dCgpIGRpc21pc3M6ICgpID0+IHZvaWQ7XG4gIEBJbnB1dCgpIHRpdGxlOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGJvZHk6IHN0cmluZztcbiAgQElucHV0KCkgY3VzdG9tRm9vdGVyOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgpIHNldCBsYWJlbHMoe29rLCBjYW5jZWx9OiBNb2RhbExhYmVscykge1xuICAgIHRoaXMuX2xhYmVscyA9IHtvayAsIGNhbmNlbH07XG4gIH1cblxuICBnZXQgbGFiZWxzKCk6IE1vZGFsTGFiZWxzIHsgcmV0dXJuIHRoaXMuX2xhYmVsczsgfVxuXG4gIHByaXZhdGUgX2xhYmVsczogTW9kYWxMYWJlbHMgPSAgeyBvazogZ2V0dGV4dCgnT0snKSwgY2FuY2VsOiBnZXR0ZXh0KCdDYW5jZWwnKSB9O1xuXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIHByaXZhdGUgbW9kYWw6IEJzTW9kYWxSZWYpIHt9XG5cbiAgX2Rpc21pc3MoKSB7XG4gICAgbGV0IGZuID0gdGhpcy5kaXNtaXNzO1xuICAgIGlmICghZm4gJiYgdGhpcy5tb2RhbCkgeyBmbiA9ICgpID0+IHRoaXMubW9kYWwuaGlkZSgpOyB9XG4gICAgaWYgKGZuKSB7IGZuKCk7IH1cbiAgICB0aGlzLm9uRGlzbWlzcy5lbWl0KHRydWUpO1xuICB9XG5cbiAgX2Nsb3NlKCkge1xuICAgIGxldCBmbiA9IHRoaXMuY2xvc2U7XG4gICAgaWYgKCFmbiAmJiB0aGlzLm1vZGFsKSB7IGZuID0gKCkgPT4gdGhpcy5tb2RhbC5oaWRlKCk7IH1cbiAgICBpZiAoZm4pIHsgZm4oKTsgfVxuICAgIHRoaXMub25DbG9zZS5lbWl0KHRydWUpO1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6a2V5ZG93bi5lbnRlcicsIFsnJGV2ZW50J10pIG9uRW50ZXJLZXlEb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgY29uc3QgaGFzT25seU9uZUJ1dHRvbiA9IGlzRW1wdHkodGhpcy5sYWJlbHMub2spICE9PSBpc0VtcHR5KHRoaXMubGFiZWxzLmNhbmNlbCk7XG4gICAgY29uc3QgaXNDYW5jZWxDbGlja2FibGUgPSAhdGhpcy5jdXN0b21Gb290ZXIgJiYgdGhpcy5sYWJlbHMuY2FuY2VsO1xuICAgIGNvbnN0IGlzT2tDbGlja2FibGUgPSAhdGhpcy5jdXN0b21Gb290ZXIgJiYgIXRoaXMuZGlzYWJsZWQgJiYgdGhpcy5sYWJlbHMub2s7XG4gICAgaWYgKGhhc09ubHlPbmVCdXR0b24gICYmIGlzQ2FuY2VsQ2xpY2thYmxlKSB7XG4gICAgICB0aGlzLl9kaXNtaXNzKCk7XG4gICAgfVxuICAgIGlmIChoYXNPbmx5T25lQnV0dG9uICAmJiBpc09rQ2xpY2thYmxlKSB7XG4gICAgICB0aGlzLl9jbG9zZSgpO1xuICAgIH1cbiAgfVxufVxuIl19