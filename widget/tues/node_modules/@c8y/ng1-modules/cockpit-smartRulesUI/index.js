"use strict";!function(){a.$inject=["c8yUiUtil","c8yNavigator"],e.$inject=["c8yNavigatorProvider","c8yViewsProvider","c8yTitleProvider","c8yBreadcrumbsProvider","smartRulesTemplateBasePath","gettext"],angular.module("c8y.smartRulesUI",["c8y.smartRules"]).config(e).run(a);var m="rules";function e(e,a,t,n,i,r){u.$inject=["$q","c8yPermissions","c8ySmartRulesAvailability"];var o=i,c="/device/:deviceId",l=[c];function s(e){return{title:e}}function d(e){a.when(e,{priority:1e3,name:r("Info"),icon:"asterisk",showIf:["c8ySmartRulesAvailability",function(e){return e.shouldShowLocalSmartRules()}],templateUrl:"".concat(o,"list.html")})}function u(e,a,t){var n={hasInventoryReadAdminCreate:a.isAllowed({anyRole:["ROLE_INVENTORY_READ","ROLE_INVENTORY_ADMIN","ROLE_INVENTORY_CREATE"]}),hasSmartRuleReadAdmin:a.isAllowed({anyRole:["ROLE_SMARTRULE_READ","ROLE_SMARTRULE_ADMIN"]}),hasCepManagementAdmin:a.isAllowed({anyRole:["ROLE_CEP_MANAGEMENT_ADMIN"]}),isApplicationAvailable:t.isApplicationAvailable()};return e.all(n).then(function(e){return e.hasInventoryReadAdminCreate&&e.isApplicationAvailable&&(e.hasSmartRuleReadAdmin||e.hasCepManagementAdmin)})}t.addTitle(c,{data:["$routeParams","c8yBase","c8yDevices",function(e,a,t){var n=e.deviceId;return n?t.detailCached(n).then(a.getResData).then(t.properName).then(s):{}}]}),a.when("/".concat(m),{templateUrl:"".concat(o,"list.html")}),l.forEach(d),e.addNavigation({parent:{name:r("Configuration"),icon:"c8y-tools"},name:r("Global smart rules"),path:m,icon:"cogs",showIf:u}),n.addBreadcrumbs(c,{data:["$routeParams","c8yDevices",function(e,a){var t=e.deviceId;return a.getBreadcrumbsData(t)}]})}function a(e,a){e.shouldShowSmartRules().then(function(e){e||a.removeNavigation(a.findNode(function(e){return e.path===m}))})}}();